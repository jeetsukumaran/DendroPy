<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>dendropy.model.continuous: Continuous Character Evolution &#8212; DendroPy 5.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/rtd.css?v=cedc6a2f" />
    
    <script src="../_static/documentation_options.js?v=5df4c8d1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dendropy.model.discrete: Discrete Character Evolution" href="discrete.html" />
    <link rel="prev" title="dendropy.model.coalescent: The Coalescent" href="coalescent.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="discrete.html" title="dendropy.model.discrete: Discrete Character Evolution"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="coalescent.html" title="dendropy.model.coalescent: The Coalescent"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DendroPy 5.0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">DendroPy Library Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">dendropy.model.continuous</span></code>: Continuous Character Evolution</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-dendropy.model.continuous">
<span id="dendropy-model-continuous-continuous-character-evolution"></span><h1><a class="reference internal" href="#module-dendropy.model.continuous" title="dendropy.model.continuous"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dendropy.model.continuous</span></code></a>: Continuous Character Evolution<a class="headerlink" href="#module-dendropy.model.continuous" title="Link to this heading">¶</a></h1>
<p>Models and modeling of continuous character evolution.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dendropy.model.continuous.PhylogeneticIndependentContrasts">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dendropy.model.continuous.</span></span><span class="sig-name descname"><span class="pre">PhylogeneticIndependentContrasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polytomy_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dendropy/model/continuous.html#PhylogeneticIndependentContrasts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dendropy.model.continuous.PhylogeneticIndependentContrasts" title="Link to this definition">¶</a></dt>
<dd><p>Phylogenetic Independent Contrasts.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Felsenstein, J. 1985. Phylogenies and the comparative method. American
Naturalist 125:1-15.</p></li>
<li><p>Garland, T., Jr., Jr., A. F. Bennett, and E. L. Rezende. 2005.
Phylogenetic approaches in comparative physiology. Journal of
Experimental Biology 208:3015-3035.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<a class="reference internal" href="treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object) – Tree to use.</p></li>
<li><p><strong>char_matrix</strong> (<a class="reference internal" href="charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.ContinuousCharacterMatrix" title="dendropy.datamodel.charmatrixmodel.ContinuousCharacterMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContinuousCharacterMatrix</span></code></a>) – ContinuousCharacterMatrix that is the source of the data</p></li>
<li><p><strong>polytomy_strategy</strong> – <p>One of: ‘error’, ‘ignore’, ‘resolve’.</p>
<blockquote>
<div><dl class="simple">
<dt>’error’</dt><dd><p>Throws an error if tree has polytomies.</p>
</dd>
<dt>’ignore’</dt><dd><p>No error, but raw contrasts will not be calculated for
polytomies.</p>
</dd>
<dt>’resolve’</dt><dd><p>Randomly resolve polytomies.</p>
</dd>
</dl>
</div></blockquote>
<p>Defaults to ‘error’ if not specified or set to None.</p>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dendropy.model.continuous.PhylogeneticIndependentContrasts.contrasts_tree">
<span class="sig-name descname"><span class="pre">contrasts_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">character_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_pic_statistics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_values_as_node_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrected_edge_lengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dendropy/model/continuous.html#PhylogeneticIndependentContrasts.contrasts_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dendropy.model.continuous.PhylogeneticIndependentContrasts.contrasts_tree" title="Link to this definition">¶</a></dt>
<dd><p>Returns a Tree object annotated with the following attributes added
to each node (as annotations to be serialized if
<code class="docutils literal notranslate"><span class="pre">annotate_pic_statistics</span></code> is True):</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pic_state_value</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_state_variance</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_contrast_raw</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_contrast_variance</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_contrast_standardized</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_edge_length_error</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_corrected_edge_length</span></code></p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dendropy.model.continuous.PhylogeneticIndependentContrasts.tree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tree</span></span><a class="headerlink" href="#dendropy.model.continuous.PhylogeneticIndependentContrasts.tree" title="Link to this definition">¶</a></dt>
<dd><p>This tree will have an attribute added to each node, <code class="docutils literal notranslate"><span class="pre">pic</span></code>. This
attribute will be a dictionary with character (column) index as
keys. Each column index will map to another dictionary that has the
following keys (and values):</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pic_state_value</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_state_variance</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_contrast_raw</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_contrast_variance</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_contrast_standardized</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_edge_length_error</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pic_corrected_edge_length</span></code></p></li>
</ul>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dendropy.model.continuous.evolve_continuous_char">
<span class="sig-prename descclassname"><span class="pre">dendropy.model.continuous.</span></span><span class="sig-name descname"><span class="pre">evolve_continuous_char</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dendropy/model/continuous.html#evolve_continuous_char"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dendropy.model.continuous.evolve_continuous_char" title="Link to this definition">¶</a></dt>
<dd><p>Takes a node and a random number generator object, <code class="docutils literal notranslate"><span class="pre">rng</span></code> This function
“evolves” a set of rates on the subtree descending from the  <code class="docutils literal notranslate"><span class="pre">node</span></code>.</p>
<p>kwargs keys that are used are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">roeotroe</span></code></dt><dd><p>the rate of evolution of the rate of evolution. This
parameter that controls the degree of deviations away from the
molecular clock.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">min_rate</span></code></dt><dd><p>is the minimum rate (default None)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">max_rate</span></code></dt><dd><p>is the maximum rate (default None),</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">model</span></code></dt><dd><p>is a string specifying the name of the model. Currently only the
KTB (Kishino, Thorne, Bruno) is supported</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">time_attr</span></code></dt><dd><p>is a string that specifies the name of the attribute
that returns the branch length in terms of time for a node. The
default is “edge_length”</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">val_attr</span></code></dt><dd><p>is the string that specifies the name of the attribute
used to hold the value that is evolving along the nodes.  The root
of the subtree is assumed to have this field on calling of the
function.  On success all nodes in the subtree will have the
attribute.  The default is “mutation_rate”</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">mean_val_attr</span></code></dt><dd><p>if specified this is string that gives the name of
attribute in each node that is mean value for the branch (default is
None). This is filled in after time_attr and val_attr are read,
so it is permissible to have this attribute match one of thos
strings (although it will make the model odd if the mean_val_attr
is the same as the val_attr)
<code class="docutils literal notranslate"><span class="pre">constrain_rate_mode</span></code>
controls the behavior when the minimum or maximum rate is
simulated. The choices are “crop”, and “linear_bounce” “crop” means
that the rate is set to the most extreme value allowed.
“linear_bounce” considers the path of evolution of rate to be a
simple line from the ancestor’s rate to the proposed rate. The
point at which the path crosses the extreme value is determined and
the rate is “reflected off” the limiting rate at that point.  This
causes the rate to avoid the extreme values more than a simulation
of small time slices that simply rejects illegal rates.</p>
</dd>
</dl>
<p>Currently the only model supported is the one of Kishino, Thorne, and Bruno.
“Performance of a Divergence Time Estimation Method under a Probabilistic
Model of Rate Evolution.” Molecular Biology and Evolution (2001) vol. 18
(3) pp. 352-361. This model is specified by the code “KTB”. A node’s rate
is a log-normal variate with variance determined by the product of the
duration of the branch and the roeotroe parameter.  The mean of the
distribution is chosen such that mean of the log-normal is identical to the
rate at the parent. The mean_rate for the branch is the average of the rates
at the endpoints.</p>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div style="text-align: center; padding-top: 20px; padding-bottom: 5px; width: 100%;">
    <a href="../index.html"><img src="../_static/dendropy_logo.png" /></a>
</div><div style="clear:both; width: 100%; height:1px;"></div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div style="clear:both; width: 100%; height:1px;"></div>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dendropy.model.continuous</span></code>: Continuous Character Evolution</a><ul>
<li><a class="reference internal" href="#dendropy.model.continuous.PhylogeneticIndependentContrasts"><code class="docutils literal notranslate"><span class="pre">PhylogeneticIndependentContrasts</span></code></a><ul>
<li><a class="reference internal" href="#dendropy.model.continuous.PhylogeneticIndependentContrasts.contrasts_tree"><code class="docutils literal notranslate"><span class="pre">PhylogeneticIndependentContrasts.contrasts_tree</span></code></a></li>
<li><a class="reference internal" href="#dendropy.model.continuous.PhylogeneticIndependentContrasts.tree"><code class="docutils literal notranslate"><span class="pre">PhylogeneticIndependentContrasts.tree</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dendropy.model.continuous.evolve_continuous_char"><code class="docutils literal notranslate"><span class="pre">evolve_continuous_char</span></code></a></li>
</ul>
</li>
</ul>

  </div><div style="clear:both; width: 100%; height:1px;"></div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="coalescent.html"
                          title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dendropy.model.coalescent</span></code>: The Coalescent</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="discrete.html"
                          title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dendropy.model.discrete</span></code>: Discrete Character Evolution</a></p>
  </div><div style="clear:both; width: 100%; height:1px;"></div>
    <!-- Documentation -->
    <div style="border-top: double 1px white; padding-top: 10px;">
        <h3>Documentation</h3>
        <ul>
            <li><a href="../primer/downloading.html">Downloading and Installing DendroPy</a></li>
            <li><a href="../primer/index.html">The DendroPy Primer</a></li>
            <li><a href="index.html">Library API Reference</a></li>
            <li>
                <a href="../schemas/index.html">Schemas</a>
                <ul>
                    <li><a href="../schemas/fasta.html">FASTA</a></li>
                    <li><a href="../schemas/newick.html">Newick</a></li>
                    <li><a href="../schemas/nexml.html">NeXML</a></li>
                    <li><a href="../schemas/nexus.html">Nexus</a></li>
                    <li><a href="../schemas/phylip.html">PHYLIP</a></li>
                </ul>
            </li>
            <li>
                <a href="../programs/index.html">Programs</a>
                <ul>
                    <li><a href="../programs/sumtrees.html">SumTrees</a></li>
                </ul>
            </li>
            <li><a href="../glossary.html">Glossary and Terminological Reference</a></li>
            <li><a href="../developer.html">Developer Guide</a></li>
            <li><a href="../planning.html">Ongoing Development</a></li>
            <li><a href="../changes.html">Change History</a></li>
        </ul>
    </div>

    <!-- Downloads -->
    <div style="border-top: double 1px white; padding-top: 10px;">
        <h3>Obtaining</h3>
        <ul>
            <li><a target="_blank" href="http://pypi.python.org/pypi/DendroPy">Install from the Python Package Index</a></li>
            <li><a target="_blank" href="http://pypi.python.org/packages/source/D/DendroPy/DendroPy-5.0.2.tar.gz">Download the Source Code Archive</a></li>
            <li><a target="_blank" href="http://github.com/jeetsukumaran/DendroPy">Clone the Source Code Repository</a></li>
        </ul>
    </div>

    <!-- Discussions -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative;">
        <h3><span style="text-align: left">Discussion</span><span style="position: absolute; right: 0; top: 10px "><img src="../_static/google-groups-logo1.png" height="20px" alt="Google Groups" /></span></h3>
        <div style="margin-top: 15px;">
            <p style="font-size: 90%; margin-top: 3px; clear: both;">Join the <a href="http://groups.google.com/group/dendropy-users?hl=en">&quot; DendroPy Users&quot; </a>group to follow and participate in discussion, troubleshooting, help, information, suggestions, etc. on the usage and development of the DendroPy phylogenetic computing library.</p>
            <form action="http://groups.google.com/group/dendropy-users/boxsubscribe">
                <input type=text name=email>
                <input type=submit name="sub" value="Subscribe">
            </form>
            <p style="font-size: 90%; clear: both; padding-top: 5px; padding-bottom: 10px;">Enter your e-mail address in the box above and click the &quot;subscribe&quot; button to subscribe to the <a href="http://groups.google.com/group/dendropy-users?hl=en">&quot;dendropy-users&quot;</a> group, or click <a href="http://groups.google.com/group/dendropy-users?hl=en">here</a> to visit this group page directly.</p>
        </div>
    </div>

    <!-- Announcements -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative;">
        <h3><span style="text-align: left">Announcements</span><span style="position: absolute; right: 0; top: 10px "><img src="../_static/google-groups-logo1.png" height="20px" alt="Google Groups" /></span></h3>
        <div style="margin-top: 15px;">
            <p style="font-size: 90%; margin-top: 3px; clear: both;">Join the <a href="http://groups.google.com/group/dendropy-announce?hl=en">&quot; DendroPy Announcements&quot; </a>group to receive announcements of new releases, updates, changes and other news of interest to DendroPy users and developers.</p>
            <form action="http://groups.google.com/group/dendropy-announce/boxsubscribe">
                <input type=text name=email>
                <input type=submit name="sub" value="Subscribe">
            </form>
            <p style="font-size: 90%; clear: both; padding-top: 5px; padding-bottom: 10px;">Enter your e-mail address in the box above and click the &quot;subscribe&quot; button to subscribe to the <a href="http://groups.google.com/group/dendropy-announce?hl=en">&quot; dendropy-announce&quot; </a>group, or click <a href="http://groups.google.com/group/dendropy-announce?hl=en">here</a> to visit this group page directly.</p>
        </div>
    </div>

    <!-- Development -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative; padding-bottom: 15px; margin-bottom:5px;">
        <h3><span style="text-align: left"><a href="https://github.com/jeetsukumaran/DendroPy/">Development</a></span><a href="https://github.com/jeetsukumaran/DendroPy/"><span style="position: absolute; right: 0; top: 10px "><img src="../_static/Octocat.png" height="30px" alt="GitHub" /></span></a></h3>
        <div style="margin-top: 15px;">
            <!-- <a href="https://github.com/jeetsukumaran/DendroPy/issues">Issues</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/subscription">Watch</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/fork">Fork</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/stargazers">Star</a> &bull; <a href="https://github.com/jeetsukumaran/">Follow</a> -->
            <ul>
                <li>                <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/issues"><code>Issues</code></a></span> <span style="font-style: italic; font-size:80%;"> - Report bugs or request features</span></li>
                <li>     <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/subscription"><code>&nbsp;Watch</code></a></span> <span style="font-style: italic; font-size:80%;"> - Follow development activity</span></li>
                <li>        <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/fork"><code>&nbsp;&nbsp;Fork</code></a></span> <span style="font-style: italic; font-size:80%;"> - Contribute and collaborate</span></li>
                <li>  <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/stargazers"><code>&nbsp;&nbsp;Star</code></a></span> <span style="font-style: italic; font-size:80%;"> - Throw some glitter, add some glamour</span></li>
        </div>
    </div>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="discrete.html" title="dendropy.model.discrete: Discrete Character Evolution"
             >next</a> |</li>
        <li class="right" >
          <a href="coalescent.html" title="dendropy.model.coalescent: The Coalescent"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DendroPy 5.0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >DendroPy Library Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">dendropy.model.continuous</span></code>: Continuous Character Evolution</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2009-2024, Jeet Sukumaran and Mark T. Holder.
    </div>
  </body>
</html>