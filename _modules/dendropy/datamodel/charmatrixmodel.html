<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>dendropy.datamodel.charmatrixmodel &#8212; DendroPy 5.0.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/rtd.css?v=cedc6a2f" />
    
    <script src="../../../_static/documentation_options.js?v=3205dc05"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DendroPy 5.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">dendropy.datamodel.charmatrixmodel</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for dendropy.datamodel.charmatrixmodel</h1><div class="highlight"><pre>
<span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1">##############################################################################</span>
<span class="c1">##  DendroPy Phylogenetic Computing Library.</span>
<span class="c1">##</span>
<span class="c1">##  Copyright 2010-2015 Jeet Sukumaran and Mark T. Holder.</span>
<span class="c1">##  All rights reserved.</span>
<span class="c1">##</span>
<span class="c1">##  See &quot;LICENSE.rst&quot; for terms and conditions of usage.</span>
<span class="c1">##</span>
<span class="c1">##  If you use this work or any portion thereof in published work,</span>
<span class="c1">##  please cite it as:</span>
<span class="c1">##</span>
<span class="c1">##     Sukumaran, J. and M. T. Holder. 2010. DendroPy: a Python library</span>
<span class="c1">##     for phylogenetic computing. Bioinformatics 26: 1569-1571.</span>
<span class="c1">##</span>
<span class="c1">##############################################################################</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Character and character-sequence data structures.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">from</span> <span class="nn">dendropy.utility</span> <span class="kn">import</span> <span class="n">textprocessing</span>
<span class="kn">from</span> <span class="nn">dendropy.utility</span> <span class="kn">import</span> <span class="n">error</span>
<span class="kn">from</span> <span class="nn">dendropy.utility</span> <span class="kn">import</span> <span class="n">deprecate</span>
<span class="kn">from</span> <span class="nn">dendropy.utility</span> <span class="kn">import</span> <span class="n">container</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel</span> <span class="kn">import</span> <span class="n">charstatemodel</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel.charstatemodel</span> <span class="kn">import</span> <span class="n">DNA_STATE_ALPHABET</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel.charstatemodel</span> <span class="kn">import</span> <span class="n">RNA_STATE_ALPHABET</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel.charstatemodel</span> <span class="kn">import</span> <span class="n">NUCLEOTIDE_STATE_ALPHABET</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel.charstatemodel</span> <span class="kn">import</span> <span class="n">PROTEIN_STATE_ALPHABET</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel.charstatemodel</span> <span class="kn">import</span> <span class="n">RESTRICTION_SITES_STATE_ALPHABET</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel.charstatemodel</span> <span class="kn">import</span> <span class="n">INFINITE_SITES_STATE_ALPHABET</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel</span> <span class="kn">import</span> <span class="n">basemodel</span>
<span class="kn">from</span> <span class="nn">dendropy.datamodel</span> <span class="kn">import</span> <span class="n">taxonmodel</span>
<span class="kn">from</span> <span class="nn">dendropy</span> <span class="kn">import</span> <span class="n">dataio</span>

<span class="c1">###############################################################################</span>
<span class="c1">## ContinuousCharElement</span>

<span class="k">class</span> <span class="nc">ContinuousCharElement</span><span class="p">(</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">DataObject</span><span class="p">,</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">Annotable</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">column_def</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">DataObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_def</span> <span class="o">=</span> <span class="n">column_def</span>

<span class="c1">###############################################################################</span>
<span class="c1">## CharacterType</span>

<div class="viewcode-block" id="CharacterType">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterType">[docs]</a>
<span class="k">class</span> <span class="nc">CharacterType</span><span class="p">(</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">DataObject</span><span class="p">,</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">Annotable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A character format or type of a particular column: i.e., maps a particular</span>
<span class="sd">    set of character state definitions to a column in a character matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">state_alphabet</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">DataObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state_alphabet</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_alphabet</span> <span class="o">=</span> <span class="n">state_alphabet</span>

    <span class="k">def</span> <span class="nf">_get_state_alphabet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The |StateAlphabet| representing the state alphabet for this</span>
<span class="sd">        column: i.e., the collection of symbols and the state identities to</span>
<span class="sd">        which they map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_alphabet</span>
    <span class="k">def</span> <span class="nf">_set_state_alphabet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state_alphabet</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">state_alphabet</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_state_alphabet</span><span class="p">,</span> <span class="n">_set_state_alphabet</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot directly copy </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

<div class="viewcode-block" id="CharacterType.taxon_namespace_scoped_copy">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterType.taxon_namespace_scoped_copy">[docs]</a>
    <span class="k">def</span> <span class="nf">taxon_namespace_scoped_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot directly copy </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span></div>


    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">basemodel</span><span class="o">.</span><span class="n">Annotable</span><span class="o">.</span><span class="n">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">)</span></div>


<span class="c1">###############################################################################</span>
<span class="c1">## CharacterDataSequence</span>

<div class="viewcode-block" id="CharacterDataSequence">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence">[docs]</a>
<span class="k">class</span> <span class="nc">CharacterDataSequence</span><span class="p">(</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">Annotable</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A sequence of character values or values for a particular taxon or entry in</span>
<span class="sd">    a data matrix.</span>

<span class="sd">    Objects of this class can be (almost) treated as simple lists, where the</span>
<span class="sd">    elements are the values of characters (typically, real values in the case</span>
<span class="sd">    of continuous data, and special instances of |StateIdentity| objects in the</span>
<span class="sd">    case of discrete data.</span>

<span class="sd">    Character type data (represented by |CharacterType| instances) and metadata</span>
<span class="sd">    annotations (represented by |AnnotationSet| instances), if any, are</span>
<span class="sd">    maintained in a parallel list that need to be accessed separately using the</span>
<span class="sd">    index of the value to which the data correspond. So, for example, the</span>
<span class="sd">    |AnnotationSet| object containing the metadata annotations for the first</span>
<span class="sd">    value in a sequence, ``s[0]``, is available through</span>
<span class="sd">    ``s.annotations_at(0)``, while the character type information for that</span>
<span class="sd">    first element is available through ``s.character_type_at(0)`` and can be</span>
<span class="sd">    set through ``s.set_character_type_at(0, c)``.</span>

<span class="sd">    In most cases where metadata annotations and character type information are</span>
<span class="sd">    not needed, treating objects of this class as a simple list provides all</span>
<span class="sd">    the functionality needed. Where metadata annotations or character type</span>
<span class="sd">    information are required, all the standard list mutation methods (e.g.,</span>
<span class="sd">    ``CharacterDataSequence.insert``, ``CharacterDataSequence.append``,</span>
<span class="sd">    ``CharacterDataSequence.extend``) also take optional ``character_type``</span>
<span class="sd">    and ``character_annotations`` argument in addition to the primary</span>
<span class="sd">    ``character_value`` argument, thus allowing for setting of the value,</span>
<span class="sd">    character type, and annotation set simultaneously. While iteration over</span>
<span class="sd">    character values are available through the standard list iteration</span>
<span class="sd">    interface, the method ``CharacterDataSequence.cell_iter()`` provides for</span>
<span class="sd">    iterating over ``&lt;character-value, character-type,</span>
<span class="sd">    character-annotation-set&gt;`` triplets.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">###############################################################################</span>
    <span class="c1">## Life-cycle</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">character_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">character_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">character_annotations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        character_values : iterable of values</span>
<span class="sd">            A set of values for this sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">character_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="n">character_values</span><span class="o">=</span><span class="n">character_values</span><span class="p">,</span>
                    <span class="n">character_types</span><span class="o">=</span><span class="n">character_types</span><span class="p">,</span>
                    <span class="n">character_annotations</span><span class="o">=</span><span class="n">character_annotations</span><span class="p">)</span>

    <span class="c1">###############################################################################</span>
    <span class="c1">## Life-cycle</span>

    <span class="c1"># def values(self):</span>
    <span class="c1">#     return list(self._character_values)</span>

<div class="viewcode-block" id="CharacterDataSequence.values">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.values">[docs]</a>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of values of this vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        v : list</span>
<span class="sd">            List of values making up this vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span></div>


<div class="viewcode-block" id="CharacterDataSequence.symbols_as_list">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.symbols_as_list">[docs]</a>
    <span class="k">def</span> <span class="nf">symbols_as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of string representation of values of this vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        v : list</span>
<span class="sd">            List of string representation of values making up this vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span> <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterDataSequence.symbols_as_string">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.symbols_as_string">[docs]</a>
    <span class="k">def</span> <span class="nf">symbols_as_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns values of this vector as a single string, with individual value</span>
<span class="sd">        elements separated by ``sep``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        s : string</span>
<span class="sd">            String representation of values making up this vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span> <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols_as_string</span><span class="p">()</span>

<div class="viewcode-block" id="CharacterDataSequence.append">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.append">[docs]</a>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">character_value</span><span class="p">,</span> <span class="n">character_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">character_annotations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a value to ``self``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        character_value : object</span>
<span class="sd">            Value to be stored.</span>
<span class="sd">        character_type : |CharacterType|</span>
<span class="sd">            Description of character value.</span>
<span class="sd">        character_annotations : |AnnotationSet|</span>
<span class="sd">            Metadata annotations associated with this character.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">character_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">character_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">character_annotations</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterDataSequence.extend">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.extend">[docs]</a>
    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">character_values</span><span class="p">,</span> <span class="n">character_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">character_annotations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extends ``self`` with values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        character_values : iterable of objects</span>
<span class="sd">            Values to be stored.</span>
<span class="sd">        character_types : iterable of |CharacterType| objects</span>
<span class="sd">            Descriptions of character values.</span>
<span class="sd">        character_annotations : iterable |AnnotationSet| objects</span>
<span class="sd">            Metadata annotations associated with characters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">character_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">character_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">character_values</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">character_types</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">character_values</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">character_types</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">character_annotations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">character_values</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">character_annotations</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">character_values</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">character_annotations</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">v</span>

<div class="viewcode-block" id="CharacterDataSequence.cell_iter">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.cell_iter">[docs]</a>
    <span class="k">def</span> <span class="nf">cell_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterate over triplets of character values and associated</span>
<span class="sd">        |CharacterType| and |AnnotationSet| instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">v</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">a</span></div>


    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<div class="viewcode-block" id="CharacterDataSequence.set_at">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.set_at">[docs]</a>
    <span class="k">def</span> <span class="nf">set_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">character_value</span><span class="p">,</span> <span class="n">character_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">character_annotations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set value and associated character type and metadata annotations for</span>
<span class="sd">        element at ``idx``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : integer</span>
<span class="sd">            Index of element to set.</span>
<span class="sd">        character_value : object</span>
<span class="sd">            Value to be stored.</span>
<span class="sd">        character_type : |CharacterType|</span>
<span class="sd">            Description of character value.</span>
<span class="sd">        character_annotations : |AnnotationSet|</span>
<span class="sd">            Metadata annotations associated with this character.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_add</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">to_add</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">to_add</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">character_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">character_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">character_annotations</span></div>


<div class="viewcode-block" id="CharacterDataSequence.insert">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.insert">[docs]</a>
    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">character_value</span><span class="p">,</span> <span class="n">character_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">character_annotations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert value and associated character type and metadata annotations for</span>
<span class="sd">        element at ``idx``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : integer</span>
<span class="sd">            Index of element to set.</span>
<span class="sd">        character_value : object</span>
<span class="sd">            Value to be stored.</span>
<span class="sd">        character_type : |CharacterType|</span>
<span class="sd">            Description of character value.</span>
<span class="sd">        character_annotations : |AnnotationSet|</span>
<span class="sd">            Metadata annotations associated with this character.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">character_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">character_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">character_annotations</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterDataSequence.value_at">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.value_at">[docs]</a>
    <span class="k">def</span> <span class="nf">value_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return value of character at ``idx``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : integer</span>
<span class="sd">            Index of element value to return.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        c : object</span>
<span class="sd">            Value of character at index ``idx``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></div>


<div class="viewcode-block" id="CharacterDataSequence.character_type_at">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.character_type_at">[docs]</a>
    <span class="k">def</span> <span class="nf">character_type_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return type of character at ``idx``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : integer</span>
<span class="sd">            Index of element character type to return.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        c : |CharacterType|</span>
<span class="sd">            |CharacterType| associated with character index ``idx``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></div>


<div class="viewcode-block" id="CharacterDataSequence.annotations_at">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.annotations_at">[docs]</a>
    <span class="k">def</span> <span class="nf">annotations_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return metadata annotations of character at ``idx``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : integer</span>
<span class="sd">            Index of element annotations to return.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        c : |AnnotationSet|</span>
<span class="sd">            |AnnotationSet| representing metadata annotations of character at index ``idx``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">basemodel</span><span class="o">.</span><span class="n">AnnotationSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></div>


<div class="viewcode-block" id="CharacterDataSequence.has_annotations_at">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.has_annotations_at">[docs]</a>
    <span class="k">def</span> <span class="nf">has_annotations_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return |True| if character at ``idx`` has metadata annotations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : integer</span>
<span class="sd">            Index of element annotations to check.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        b : bool</span>
<span class="sd">            |True| if character at ``idx`` has metadata annotations, |False|</span>
<span class="sd">            otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="CharacterDataSequence.set_character_type_at">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.set_character_type_at">[docs]</a>
    <span class="k">def</span> <span class="nf">set_character_type_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">character_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set type of character at ``idx``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : integer</span>
<span class="sd">            Index of element character type to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_types</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">character_type</span></div>


<div class="viewcode-block" id="CharacterDataSequence.set_annotations_at">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterDataSequence.set_annotations_at">[docs]</a>
    <span class="k">def</span> <span class="nf">set_annotations_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">annotations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set metadata annotations of character at ``idx``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : integer</span>
<span class="sd">            Index of element annotations to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_character_annotations</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotations</span></div>
</div>


<span class="c1">###############################################################################</span>
<span class="c1">## Subset of Character (Columns)</span>

<div class="viewcode-block" id="CharacterSubset">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterSubset">[docs]</a>
<span class="k">class</span> <span class="nc">CharacterSubset</span><span class="p">(</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">DataObject</span><span class="p">,</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">Annotable</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tracks definition of a subset of characters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">character_indices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label: str</span>
<span class="sd">            Name of this subset.</span>
<span class="sd">        character_indices: iterable of ``int``</span>
<span class="sd">            Iterable of 0-based (integer) indices of column positions that</span>
<span class="sd">            constitute this subset.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">DataObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">character_indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">character_indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">character_indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">character_indices</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">character_indices</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">character_indices</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">basemodel</span><span class="o">.</span><span class="n">Annotable</span><span class="o">.</span><span class="n">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">)</span></div>


<span class="c1">###############################################################################</span>
<span class="c1">## CharacterMatrix</span>

<div class="viewcode-block" id="CharacterMatrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix">[docs]</a>
<span class="k">class</span> <span class="nc">CharacterMatrix</span><span class="p">(</span>
        <span class="n">taxonmodel</span><span class="o">.</span><span class="n">TaxonNamespaceAssociated</span><span class="p">,</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">Annotable</span><span class="p">,</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">Deserializable</span><span class="p">,</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">NonMultiReadable</span><span class="p">,</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">Serializable</span><span class="p">,</span>
        <span class="n">basemodel</span><span class="o">.</span><span class="n">DataObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A data structure that manages assocation of operational taxononomic unit</span>
<span class="sd">    concepts to sequences of character state identities or values.</span>

<span class="sd">    This is a base class that provides general functionality; derived classes</span>
<span class="sd">    specialize for particular data types. You will not be using the class</span>
<span class="sd">    directly, but rather one of the derived classes below, specialized for data</span>
<span class="sd">    types such as DNA, RNA, continuous, etc.</span>

<span class="sd">    This class and derived classes behave like a dictionary where the keys are</span>
<span class="sd">    |Taxon| objects and the values are `CharacterDataSequence` objects. Access</span>
<span class="sd">    to sequences based on taxon labels as well as indexes are also provided.</span>
<span class="sd">    Numerous methods are provided to manipulate and iterate over sequences.</span>
<span class="sd">    Character partitions can be managed through `CharacterSubset` objects,</span>
<span class="sd">    while management of detailed metadata on character types are available</span>
<span class="sd">    through |CharacterType| objects.</span>

<span class="sd">    Objects can be instantiated by reading data from external sources through</span>
<span class="sd">    the usual ``get_from_stream()``, ``get_from_path()``, or</span>
<span class="sd">    ``get_from_string()`` functions. In addition, a single matrix object can be</span>
<span class="sd">    instantiated from multiple matrices (``concatenate()``) or data sources</span>
<span class="sd">    (``concatenate_from_paths``).</span>

<span class="sd">    A range of methods also exist for importing data from another matrix object.</span>
<span class="sd">    These vary depending on how &quot;new&quot; and &quot;existing&quot; are treated.  A &quot;new&quot;</span>
<span class="sd">    sequence is a sequence in the other matrix associated with a |Taxon|</span>
<span class="sd">    object for which there is no sequence defined in the current matrix.  An</span>
<span class="sd">    &quot;existing&quot; sequence is a sequence in the other matrix associated with a</span>
<span class="sd">    |Taxon| object for which there *is* a sequence defined in the</span>
<span class="sd">    current matrix.</span>

<span class="sd">    +---------------------------------+---------------------------------------------+--------------------------------------------+</span>
<span class="sd">    |                                 | New Sequences: IGNORED                      | New Sequences: ADDED                       |</span>
<span class="sd">    +=================================+=============================================+============================================+</span>
<span class="sd">    | Existing Sequences: IGNORED     | [NO-OP]                                     | :meth:`CharacterMatrix.add_sequences()`    |</span>
<span class="sd">    +---------------------------------+---------------------------------------------+--------------------------------------------+</span>
<span class="sd">    | Existing Sequences: OVERWRITTEN | :meth:`CharacterMatrix.replace_sequences()` | :meth:`CharacterMatrix.update_sequences()` |</span>
<span class="sd">    +---------------------------------+---------------------------------------------+--------------------------------------------+</span>
<span class="sd">    | Existing Sequences: EXTENDED    | :meth:`CharacterMatrix.extend_sequences()`  | :meth:`CharacterMatrix.extend_matrix()`    |</span>
<span class="sd">    +---------------------------------+---------------------------------------------+--------------------------------------------+</span>

<span class="sd">    If character subsets have been defined, these subsets can be exported to independent matrices.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Class Variables</span>

    <span class="n">data_type</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">CharacterDataSequence</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Factory (Class) Methods</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_parse_and_create_from_stream</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
            <span class="n">stream</span><span class="p">,</span>
            <span class="n">schema</span><span class="p">,</span>
            <span class="n">matrix_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">taxon_namespace</span> <span class="o">=</span> <span class="n">taxonmodel</span><span class="o">.</span><span class="n">process_kwargs_dict_for_taxon_namespace</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">taxon_namespace</span> <span class="o">=</span> <span class="n">taxonmodel</span><span class="o">.</span><span class="n">TaxonNamespace</span><span class="p">(</span><span class="n">is_case_sensitive</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;case_sensitive_taxon_labels&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
        <span class="k">def</span> <span class="nf">tns_factory</span><span class="p">(</span><span class="n">label</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">taxon_namespace</span><span class="o">.</span><span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">taxon_namespace</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
            <span class="k">return</span> <span class="n">taxon_namespace</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;data_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">data_type</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">dataio</span><span class="o">.</span><span class="n">get_reader</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">char_matrices</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_char_matrices</span><span class="p">(</span>
                <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span>
                <span class="n">taxon_namespace_factory</span><span class="o">=</span><span class="n">tns_factory</span><span class="p">,</span>
                <span class="n">char_matrix_factory</span><span class="o">=</span><span class="n">new_char_matrix</span><span class="p">,</span>
                <span class="n">state_alphabet_factory</span><span class="o">=</span><span class="n">charstatemodel</span><span class="o">.</span><span class="n">StateAlphabet</span><span class="p">,</span>
                <span class="n">global_annotations_target</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">char_matrices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No character data in data source&quot;</span><span class="p">)</span>
        <span class="n">char_matrix</span> <span class="o">=</span> <span class="n">char_matrices</span><span class="p">[</span><span class="n">matrix_offset</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">char_matrix</span><span class="o">.</span><span class="n">data_type</span> <span class="o">!=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">data_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Data source (at offset </span><span class="si">{}</span><span class="s2">) is of type &#39;</span><span class="si">{}</span><span class="s2">&#39;, &quot;</span>
                <span class="s2">&quot;but current CharacterMatrix is of type &#39;</span><span class="si">{}</span><span class="s2">&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">matrix_offset</span><span class="p">,</span>
                    <span class="n">char_matrix</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">data_type</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">char_matrix</span>

<div class="viewcode-block" id="CharacterMatrix.get">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.get">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiate and return a *new* character matrix object from a data source.</span>

<span class="sd">        **Mandatory Source-Specification Keyword Argument (Exactly One of the Following Required):**</span>

<span class="sd">            - **file** (*file*) -- File or file-like object of data opened for reading.</span>
<span class="sd">            - **path** (*str*) -- Path to file of data.</span>
<span class="sd">            - **url** (*str*) -- URL of data.</span>
<span class="sd">            - **data** (*str*) -- Data given directly.</span>

<span class="sd">        **Mandatory Schema-Specification Keyword Argument:**</span>

<span class="sd">            - **schema** (*str*) -- Identifier of format of data given by the</span>
<span class="sd">              &quot;``file``&quot;, &quot;``path``&quot;, &quot;``data``&quot;, or &quot;``url``&quot; argument</span>
<span class="sd">              specified above: &quot;:doc:`fasta &lt;/schemas/fasta&gt;`&quot;, &quot;:doc:`nexus</span>
<span class="sd">              &lt;/schemas/nexus&gt;`&quot;, or &quot;:doc:`nexml &lt;/schemas/nexml&gt;`&quot;,</span>
<span class="sd">              &quot;:doc:`phylip &lt;/schemas/phylip&gt;`&quot;, etc.</span>
<span class="sd">              See &quot;|Schemas|&quot; for more details.</span>

<span class="sd">        **Optional General Keyword Arguments:**</span>

<span class="sd">            - **label** (*str*) -- Name or identifier to be assigned to the new</span>
<span class="sd">              object; if not given, will be assigned the one specified in the</span>
<span class="sd">              data source, or |None| otherwise.</span>
<span class="sd">            - **taxon_namespace** (|TaxonNamespace|) -- The |TaxonNamespace|</span>
<span class="sd">              instance to use to :doc:`manage the taxon names &lt;/primer/taxa&gt;`.</span>
<span class="sd">              If not specified, a new one will be created.</span>
<span class="sd">            - **matrix_offset** (*int*) -- 0-based index of character block or</span>
<span class="sd">              matrix in source to be parsed. If not specified then the</span>
<span class="sd">              first matrix (offset = 0) is assumed.</span>
<span class="sd">            - **ignore_unrecognized_keyword_arguments** (*bool*) -- If |True|,</span>
<span class="sd">              then unsupported or unrecognized keyword arguments will not</span>
<span class="sd">              result in an error. Default is |False|: unsupported keyword</span>
<span class="sd">              arguments will result in an error.</span>

<span class="sd">        **Optional Schema-Specific Keyword Arguments:**</span>

<span class="sd">        These provide control over how the data is interpreted and</span>
<span class="sd">        processed, and supported argument names and values depend on</span>
<span class="sd">        the schema as specified by the value passed as the &quot;``schema``&quot;</span>
<span class="sd">        argument. See &quot;|Schemas|&quot; for more details.</span>

<span class="sd">        **Examples:**</span>

<span class="sd">        ::</span>

<span class="sd">            dna1 = dendropy.DnaCharacterMatrix.get(</span>
<span class="sd">                    file=open(&quot;pythonidae.fasta&quot;),</span>
<span class="sd">                    schema=&quot;fasta&quot;)</span>
<span class="sd">            dna2 = dendropy.DnaCharacterMatrix.get(</span>
<span class="sd">                    url=&quot;http://purl.org/phylo/treebase/phylows/matrix/TB2:M2610?format=nexus&quot;,</span>
<span class="sd">                    schema=&quot;nexus&quot;)</span>
<span class="sd">            aa1 = dendropy.ProteinCharacterMatrix.get(</span>
<span class="sd">                    file=open(&quot;pythonidae.dat&quot;),</span>
<span class="sd">                    schema=&quot;phylip&quot;)</span>
<span class="sd">            std1 = dendropy.StandardCharacterMatrix.get(</span>
<span class="sd">                    path=&quot;python_morph.nex&quot;,</span>
<span class="sd">                    schema=&quot;nexus&quot;)</span>
<span class="sd">            std2 = dendropy.StandardCharacterMatrix.get(</span>
<span class="sd">                    data=&quot;&gt;t1\n01011\n\n&gt;t2\n11100&quot;,</span>
<span class="sd">                    schema=&quot;fasta&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_from</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterMatrix.concatenate">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.concatenate">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">concatenate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">char_matrices</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates and returns a single character matrix from multiple</span>
<span class="sd">        CharacterMatrix objects specified as a list, &#39;char_matrices&#39;.</span>
<span class="sd">        All the CharacterMatrix objects in the list must be of the</span>
<span class="sd">        same type, and share the same TaxonNamespace reference. All taxa</span>
<span class="sd">        must be present in all alignments, all all alignments must</span>
<span class="sd">        be of the same length. Component parts will be recorded as</span>
<span class="sd">        character subsets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">taxon_namespace</span> <span class="o">=</span> <span class="n">char_matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">taxon_namespace</span>
        <span class="n">nseqs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">char_matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">concatenated_chars</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">taxon_namespace</span><span class="o">=</span><span class="n">taxon_namespace</span><span class="p">)</span>
        <span class="n">pos_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">cidx</span><span class="p">,</span> <span class="n">cm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">char_matrices</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cm</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">taxon_namespace</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Different ``taxon_namespace`` references in matrices to be merged&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">taxon_namespace</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of sequences not equal to the number of taxa&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span> <span class="o">!=</span> <span class="n">nseqs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Different number of sequences across alignments: </span><span class="si">%d</span><span class="s2"> (expecting </span><span class="si">%d</span><span class="s2"> based on first matrix)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">),</span> <span class="n">nseqs</span><span class="p">))</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">!=</span> <span class="n">v1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unequal length sequences in character matrix </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cidx</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">concatenated_chars</span><span class="o">.</span><span class="n">extend_matrix</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cm</span><span class="o">.</span><span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_label</span> <span class="o">=</span> <span class="s2">&quot;locus</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cidx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_label</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">label</span>
            <span class="n">cs_label</span> <span class="o">=</span> <span class="n">new_label</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">while</span> <span class="n">cs_label</span> <span class="ow">in</span> <span class="n">concatenated_chars</span><span class="o">.</span><span class="n">character_subsets</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">new_label</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">character_indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">pos_start</span><span class="p">,</span> <span class="n">pos_start</span> <span class="o">+</span> <span class="n">cm</span><span class="o">.</span><span class="n">vector_size</span><span class="p">)</span>
            <span class="n">pos_start</span> <span class="o">+=</span> <span class="n">cm</span><span class="o">.</span><span class="n">vector_size</span>
            <span class="n">concatenated_chars</span><span class="o">.</span><span class="n">new_character_subset</span><span class="p">(</span><span class="n">character_indices</span><span class="o">=</span><span class="n">character_indices</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">cs_label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">concatenated_chars</span></div>


<div class="viewcode-block" id="CharacterMatrix.concatenate_from_streams">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.concatenate_from_streams">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">concatenate_from_streams</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">streams</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read a character matrix from each file object given in ``streams``,</span>
<span class="sd">        assuming data format/schema ``schema``, and passing any keyword arguments</span>
<span class="sd">        down to the underlying specialized reader. Merge the character matrices</span>
<span class="sd">        and return the combined character matrix. Component parts will be</span>
<span class="sd">        recorded as character subsets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">taxon_namespace</span> <span class="o">=</span> <span class="n">taxonmodel</span><span class="o">.</span><span class="n">process_kwargs_dict_for_taxon_namespace</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">taxon_namespace</span> <span class="o">=</span> <span class="n">taxonmodel</span><span class="o">.</span><span class="n">TaxonNamespace</span><span class="p">(</span><span class="n">is_case_sensitive</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;case_sensitive_taxon_labels&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;taxon_namespace&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">taxon_namespace</span>
        <span class="n">char_matrices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">streams</span><span class="p">:</span>
            <span class="n">char_matrices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_from_stream</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span>
                <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">char_matrices</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterMatrix.concatenate_from_paths">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.concatenate_from_paths">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">concatenate_from_paths</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read a character matrix from each file path given in ``paths``, assuming</span>
<span class="sd">        data format/schema ``schema``, and passing any keyword arguments down to</span>
<span class="sd">        the underlying specialized reader. Merge the and return the combined</span>
<span class="sd">        character matrix. Component parts will be recorded as character</span>
<span class="sd">        subsets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">streams</span> <span class="o">=</span> <span class="p">[</span><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">streams</span> <span class="o">=</span> <span class="p">[</span><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">concatenate_from_streams</span><span class="p">(</span><span class="n">streams</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterMatrix.from_dict">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.from_dict">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
            <span class="n">source_dict</span><span class="p">,</span>
            <span class="n">char_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">case_sensitive_taxon_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates character matrix from dictionary (or similar mapping type),</span>
<span class="sd">        creating |Taxon| objects and sequences as needed.</span>

<span class="sd">        Keys must be strings representing labels |Taxon| objects or</span>
<span class="sd">        |Taxon| objects directly. If key is specified as string, then it</span>
<span class="sd">        will be dereferenced to the first existing |Taxon| object in the</span>
<span class="sd">        current taxon namespace with the same label. If no such |Taxon|</span>
<span class="sd">        object can be found, then a new |Taxon| object is created and</span>
<span class="sd">        added to the current namespace. If a key is specified as a</span>
<span class="sd">        |Taxon| object, then this is used directly. If it is not in the</span>
<span class="sd">        current taxon namespace, it will be added.</span>

<span class="sd">        Values are the sequences (more generally, iterable of values).  If</span>
<span class="sd">        values are of type `CharacterDataSequence`, then they are added</span>
<span class="sd">        as-is.  Otherwise `CharacterDataSequence` instances are</span>
<span class="sd">        created for them. Values may be coerced into types compatible with</span>
<span class="sd">        particular matrices. The classmethod ``coerce_values()`` will be</span>
<span class="sd">        called for this.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        The following creates a |DnaCharacterMatrix| instance with three</span>
<span class="sd">        sequences::</span>

<span class="sd">            d = {</span>
<span class="sd">                    &quot;s1&quot; : &quot;TCCAA&quot;,</span>
<span class="sd">                    &quot;s2&quot; : &quot;TGCAA&quot;,</span>
<span class="sd">                    &quot;s3&quot; : &quot;TG-AA&quot;,</span>
<span class="sd">            }</span>
<span class="sd">            dna = DnaCharacterMatrix.from_dict(d)</span>

<span class="sd">        Three |Taxon| objects will be created, corresponding to the</span>
<span class="sd">        labels &#39;s1&#39;, &#39;s2&#39;, &#39;s3&#39;. Each associated string sequence will be</span>
<span class="sd">        converted to a `CharacterDataSequence`, with each symbol (&quot;A&quot;, &quot;C&quot;,</span>
<span class="sd">        etc.) being replaced by the DNA state represented by the symbol.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        source_dict : dict or other mapping type</span>
<span class="sd">            Keys must be strings representing labels |Taxon| objects or</span>
<span class="sd">            |Taxon| objects directly. Values are sequences. See above</span>
<span class="sd">            for details.</span>
<span class="sd">        char_matrix : |CharacterMatrix|</span>
<span class="sd">            Instance of |CharacterMatrix| to populate with data. If not</span>
<span class="sd">            specified, a new one will be created using keyword arguments</span>
<span class="sd">            specified by ``kwargs``.</span>
<span class="sd">        case_sensitive_taxon_labels : boolean</span>
<span class="sd">            If |True|, matching of string labels specified as keys in ``d`` will</span>
<span class="sd">            be matched to |Taxon| objects in current taxon namespace</span>
<span class="sd">            with case being respected. If |False|, then case will be ignored.</span>
<span class="sd">        \*\*kwargs : keyword arguments, optional</span>
<span class="sd">            Keyword arguments to be passed to constructor of</span>
<span class="sd">            |CharacterMatrix| when creating new instance to populate, if</span>
<span class="sd">            no target instance is provided via ``char_matrix``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        char_matrix : |CharacterMatrix|</span>
<span class="sd">            |CharacterMatrix| populated by data from ``d``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">char_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">char_matrix</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">source_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">textprocessing</span><span class="o">.</span><span class="n">is_str_type</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">taxon</span> <span class="o">=</span> <span class="n">char_matrix</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">require_taxon</span><span class="p">(</span><span class="n">key</span><span class="p">,</span>
                        <span class="n">is_case_sensitive</span><span class="o">=</span><span class="n">case_sensitive_taxon_labels</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">taxon</span> <span class="o">=</span> <span class="n">key</span>
                <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">char_matrix</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
                    <span class="n">char_matrix</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">add_taxon</span><span class="p">(</span><span class="n">taxon</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">char_matrix</span><span class="o">.</span><span class="n">coerce_values</span><span class="p">(</span><span class="n">source_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">char_matrix</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">return</span> <span class="n">char_matrix</span></div>


    <span class="c1">###########################################################################</span>
    <span class="c1">### Lifecycle and Identity</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># only allow 1 positional argument</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">TooManyArgumentsError</span><span class="p">(</span><span class="n">func_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">max_args</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">CharacterMatrix</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_clone_from</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">basemodel</span><span class="o">.</span><span class="n">DataObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="n">taxonmodel</span><span class="o">.</span><span class="n">TaxonNamespaceAssociated</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">taxon_namespace</span><span class="o">=</span><span class="n">taxonmodel</span><span class="o">.</span><span class="n">process_kwargs_dict_for_taxon_namespace</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">character_types</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">character_subsets</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">OrderedCaselessDict</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># takes care of all possible initializations, including. e.g.,</span>
                <span class="c1"># tuples and so on</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">char_matrix</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unrecognized or unsupported arguments: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span>

    <span class="k">def</span> <span class="nf">_clone_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">kwargs_dict</span><span class="p">):</span>
        <span class="c1"># super(Tree, self).__init__()</span>
        <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># memo[id(tree)] = self</span>
        <span class="n">taxon_namespace</span> <span class="o">=</span> <span class="n">taxonmodel</span><span class="o">.</span><span class="n">process_kwargs_dict_for_taxon_namespace</span><span class="p">(</span><span class="n">kwargs_dict</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">)</span>
        <span class="n">memo</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">)]</span> <span class="o">=</span> <span class="n">taxon_namespace</span>
        <span class="k">if</span> <span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">src</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">t1</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
                <span class="n">t2</span> <span class="o">=</span> <span class="n">taxon_namespace</span><span class="o">.</span><span class="n">require_taxon</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">t1</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
                <span class="n">memo</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">t1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">t2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">t1</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
                <span class="n">memo</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">t1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">t1</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="vm">__dict__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">kwargs_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">taxon_namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="c1"># other._taxon_sequence_map[taxon] = self.__class__.character_sequence_type(self._taxon_sequence_map[taxon])</span>
            <span class="n">other</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span>
        <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">memo</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span> <span class="o">=</span> <span class="n">other</span>
        <span class="n">other</span><span class="o">.</span><span class="n">deep_copy_annotations_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">other</span>

<div class="viewcode-block" id="CharacterMatrix.taxon_namespace_scoped_copy">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.taxon_namespace_scoped_copy">[docs]</a>
    <span class="k">def</span> <span class="nf">taxon_namespace_scoped_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">memo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># this populates ``memo`` with references to the</span>
        <span class="c1"># the TaxonNamespace and Taxon objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">populate_memo_for_taxon_namespace_scoped_copy</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__deepcopy__</span><span class="p">(</span><span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">basemodel</span><span class="o">.</span><span class="n">Annotable</span><span class="o">.</span><span class="n">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Data I/O</span>

    <span class="c1"># def _parse_and_add_from_stream(self, stream, schema, **kwargs):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Populates objects of this type from ``schema``-formatted</span>
    <span class="c1">#     data in the file-like object source ``stream``, *replacing*</span>
    <span class="c1">#     all current data. If multiple character matrices are in the data</span>
    <span class="c1">#     source, a 0-based index of the character matrix to use can</span>
    <span class="c1">#     be specified using the ``matrix_offset`` keyword (defaults to 0, i.e., first</span>
    <span class="c1">#     character matrix).</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     warnings.warn(&quot;Repopulating a CharacterMatrix is now deprecated. Instantiate a new instance from the source instead.&quot;,</span>
    <span class="c1">#             DeprecationWarning)</span>
    <span class="c1">#     m = self.__class__._parse_and_create_from_stream(stream=stream,</span>
    <span class="c1">#             schema=schema,</span>
    <span class="c1">#             **kwargs)</span>
    <span class="c1">#     return self.clone_from(m)</span>

    <span class="k">def</span> <span class="nf">_format_and_write_to_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes out ``self`` in ``schema`` format to a destination given by</span>
<span class="sd">        file-like object ``stream``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stream : file or file-like object</span>
<span class="sd">            Destination for data.</span>
<span class="sd">        schema : string</span>
<span class="sd">            Must be a recognized character file schema, such as &quot;nexus&quot;,</span>
<span class="sd">            &quot;phylip&quot;, etc, for which a specialized writer is available. If this</span>
<span class="sd">            is not implemented for the schema specified, then a</span>
<span class="sd">            UnsupportedSchemaError is raised.</span>

<span class="sd">        \*\*kwargs : keyword arguments, optional</span>
<span class="sd">            Keyword arguments will be passed directly to the writer for the</span>
<span class="sd">            specified schema. See documentation for details on keyword</span>
<span class="sd">            arguments supported by writers of various schemas.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">dataio</span><span class="o">.</span><span class="n">get_writer</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write_char_matrices</span><span class="p">([</span><span class="bp">self</span><span class="p">],</span>
                <span class="n">stream</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Taxon Management</span>

<div class="viewcode-block" id="CharacterMatrix.reconstruct_taxon_namespace">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.reconstruct_taxon_namespace">[docs]</a>
    <span class="k">def</span> <span class="nf">reconstruct_taxon_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">unify_taxa_by_label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">taxon_mapping_memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        See `TaxonNamespaceAssociated.reconstruct_taxon_namespace`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">taxon_mapping_memo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">taxon_mapping_memo</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">original_taxa</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">original_taxon</span> <span class="ow">in</span> <span class="n">original_taxa</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">unify_taxa_by_label</span> <span class="ow">or</span> <span class="n">original_taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">taxon_mapping_memo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">original_taxon</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># taxon to use not given and</span>
                    <span class="c1"># we have not yet created a counterpart</span>
                    <span class="k">if</span> <span class="n">unify_taxa_by_label</span><span class="p">:</span>
                        <span class="c1"># this will force usage of any taxon with</span>
                        <span class="c1"># a label that matches the current taxon</span>
                        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">require_taxon</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">original_taxon</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># this will unconditionally create a new taxon</span>
                        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">new_taxon</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">original_taxon</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
                    <span class="n">taxon_mapping_memo</span><span class="p">[</span><span class="n">original_taxon</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># taxon to use is given by mapping</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">add_taxon</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">TaxonNamespaceReconstructionError</span><span class="p">(</span><span class="s2">&quot;Multiple sequences for taxon with label &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">original_taxon</span><span class="p">]</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">original_taxon</span><span class="p">]</span></div>


<div class="viewcode-block" id="CharacterMatrix.poll_taxa">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.poll_taxa">[docs]</a>
    <span class="k">def</span> <span class="nf">poll_taxa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taxa</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a set populated with all of |Taxon| instances associated</span>
<span class="sd">        with ``self``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        taxa : set()</span>
<span class="sd">            Set to populate. If not specified, a new one will be created.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        taxa : set[|Taxon|]</span>
<span class="sd">            Set of taxa associated with ``self``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">taxa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">taxa</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="n">taxa</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">taxon</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">taxa</span></div>


<div class="viewcode-block" id="CharacterMatrix.update_taxon_namespace">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.update_taxon_namespace">[docs]</a>
    <span class="k">def</span> <span class="nf">update_taxon_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        All |Taxon| objects in ``self`` that are not in</span>
<span class="sd">        ``self.taxon_namespace`` will be added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">add_taxon</span><span class="p">(</span><span class="n">taxon</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterMatrix.reindex_subcomponent_taxa">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.reindex_subcomponent_taxa">[docs]</a>
    <span class="k">def</span> <span class="nf">reindex_subcomponent_taxa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Synchronizes |Taxon| objects of map to ``taxon_namespace`` of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&#39;reindex_subcomponent_taxa()&#39; is no longer supported; use &#39;</span><span class="si">{}</span><span class="s2">.reconstruct_taxon_namespace()&#39; instead&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span></div>


    <span class="c1">###########################################################################</span>
    <span class="c1">### Sequence CRUD</span>

    <span class="k">def</span> <span class="nf">_resolve_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolves map access key into |Taxon| instance.</span>

<span class="sd">        If ``key`` is integer, assumed to be taxon index.</span>
<span class="sd">        If ``key`` string, assumed to be taxon label.</span>
<span class="sd">        Otherwise, assumed to be |Taxon| instance directly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">):</span>
                <span class="n">taxon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">textprocessing</span><span class="o">.</span><span class="n">is_str_type</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">taxon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">get_taxon</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">taxon</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">return</span> <span class="n">taxon</span>

<div class="viewcode-block" id="CharacterMatrix.new_sequence">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.new_sequence">[docs]</a>
    <span class="k">def</span> <span class="nf">new_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taxon</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new `CharacterDataSequence` associated with |Taxon|</span>
<span class="sd">        ``taxon``, and populates it with values in ``values``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        taxon : |Taxon|</span>
<span class="sd">            |Taxon| instance with which this sequence is associated.</span>
<span class="sd">        values : iterable or |None|</span>
<span class="sd">            An initial set of values with which to populate the new character</span>
<span class="sd">            sequence.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        s : `CharacterDataSequence`</span>
<span class="sd">            A new `CharacterDataSequence` associated with |Taxon|</span>
<span class="sd">            ``taxon``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Character values vector for taxon </span><span class="si">{}</span><span class="s2"> already exists&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">taxon</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Taxon </span><span class="si">{}</span><span class="s2"> is not in object taxon namespace&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">taxon</span><span class="p">)))</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">character_sequence_type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="n">cv</span>
        <span class="k">return</span> <span class="n">cv</span></div>


<div class="viewcode-block" id="CharacterMatrix.__getitem__">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.__getitem__">[docs]</a>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves sequence for ``key``, which can be a index or a label of a</span>
<span class="sd">        |Taxon| instance in the current taxon namespace, or a</span>
<span class="sd">        |Taxon| instance directly.</span>

<span class="sd">        If no sequence is currently associated with specified |Taxon|, a</span>
<span class="sd">        new one will be created. Note that the |Taxon| object must have</span>
<span class="sd">        already been defined in the curent taxon namespace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : integer, string, or |Taxon|</span>
<span class="sd">            If an integer, assumed to be an index of a |Taxon| object in</span>
<span class="sd">            the current |TaxonNamespace| object of ``self.taxon_namespace``.</span>
<span class="sd">            If a string, assumed to be a label of a |Taxon| object in</span>
<span class="sd">            the current |TaxonNamespace| object of ``self.taxon_namespace``.</span>
<span class="sd">            Otherwise, assumed to be |Taxon| instance directly. In all</span>
<span class="sd">            cases, the |Taxon| object must be (already) defined in the</span>
<span class="sd">            current taxon namespace.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        s : `CharacterDataSequence`</span>
<span class="sd">            A sequence associated with the |Taxon| instance referenced</span>
<span class="sd">            by ``key``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">taxon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_sequence</span><span class="p">(</span><span class="n">taxon</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterMatrix.__setitem__">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.__setitem__">[docs]</a>
    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns sequence ``values`` to taxon specified by ``key``, which can be a</span>
<span class="sd">        index or a label of a |Taxon| instance in the current taxon</span>
<span class="sd">        namespace, or a |Taxon| instance directly.</span>

<span class="sd">        If no sequence is currently associated with specified |Taxon|, a</span>
<span class="sd">        new one will be created.  Note that the |Taxon| object must have</span>
<span class="sd">        already been defined in the curent taxon namespace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : integer, string, or |Taxon|</span>
<span class="sd">            If an integer, assumed to be an index of a |Taxon| object in</span>
<span class="sd">            the current |TaxonNamespace| object of ``self.taxon_namespace``.</span>
<span class="sd">            If a string, assumed to be a label of a |Taxon| object in</span>
<span class="sd">            the current |TaxonNamespace| object of ``self.taxon_namespace``.</span>
<span class="sd">            Otherwise, assumed to be |Taxon| instance directly. In all</span>
<span class="sd">            cases, the |Taxon| object must be (already) defined in the</span>
<span class="sd">            current taxon namespace.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">taxon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">character_sequence_type</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">character_sequence_type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span></div>


    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns |True| if a sequence associated with ``key`` is in ``self``, or</span>
<span class="sd">        |False| otherwise.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : integer, string, or |Taxon|</span>
<span class="sd">            If an integer, assumed to be an index of a |Taxon| object in</span>
<span class="sd">            the current |TaxonNamespace| object of ``self.taxon_namespace``.</span>
<span class="sd">            If a string, assumed to be a label of a |Taxon| object in</span>
<span class="sd">            the current |TaxonNamespace| object of ``self.taxon_namespace``.</span>
<span class="sd">            Otherwise, assumed to be |Taxon| instance directly. In all</span>
<span class="sd">            cases, the |Taxon| object must be (already) defined in the</span>
<span class="sd">            current taxon namespace.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        b : boolean</span>
<span class="sd">            |True| if ``key`` is in ``self``; |False| otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<div class="viewcode-block" id="CharacterMatrix.__delitem__">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.__delitem__">[docs]</a>
    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes sequence for ``key``, which can be a index or a label of a</span>
<span class="sd">        |Taxon| instance in the current taxon namespace, or a</span>
<span class="sd">        |Taxon| instance directly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : integer, string, or |Taxon|</span>
<span class="sd">            If an integer, assumed to be an index of a |Taxon| object in</span>
<span class="sd">            the current |TaxonNamespace| object of ``self.taxon_namespace``.</span>
<span class="sd">            If a string, assumed to be a label of a |Taxon| object in</span>
<span class="sd">            the current |TaxonNamespace| object of ``self.taxon_namespace``.</span>
<span class="sd">            Otherwise, assumed to be |Taxon| instance directly. In all</span>
<span class="sd">            cases, the |Taxon| object must be (already) defined in the</span>
<span class="sd">            current taxon namespace.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterMatrix.clear">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.clear">[docs]</a>
    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all sequences from matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>


<div class="viewcode-block" id="CharacterMatrix.sequences">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.sequences">[docs]</a>
    <span class="k">def</span> <span class="nf">sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of all sequences in self.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        s : list of `CharacterDataSequence` objects in self</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">s</span></div>


    <span class="k">def</span> <span class="nf">vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">deprecate</span><span class="o">.</span><span class="n">dendropy_deprecation_warning</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Deprecated since DendroPy 4: &#39;vectors()&#39; will no longer be supported in future releases; use &#39;sequences()&#39; instead&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">()</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Symbol/alphabet management</span>

<div class="viewcode-block" id="CharacterMatrix.coerce_values">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.coerce_values">[docs]</a>
    <span class="k">def</span> <span class="nf">coerce_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts elements of ``values`` to type of matrix.</span>

<span class="sd">        This method is called by :meth:`CharacterMatrix.from_dict` to create</span>
<span class="sd">        sequences from iterables of values.  This method should be overridden</span>
<span class="sd">        by derived classes to ensure that ``values`` consists of types compatible</span>
<span class="sd">        with the particular type of matrix. For example, a CharacterMatrix type</span>
<span class="sd">        with a fixed state alphabet (such as |DnaCharacterMatrix|) would</span>
<span class="sd">        dereference the string elements of ``values`` to return a list of</span>
<span class="sd">        |StateIdentity| objects corresponding to the symbols represented</span>
<span class="sd">        by the strings.  If there is no value-type conversion done, then</span>
<span class="sd">        ``values`` should be returned as-is. If no value-type conversion is</span>
<span class="sd">        possible (e.g., when the type of a value is dependent on positionaly</span>
<span class="sd">        information), then a TypeError should be raised.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values : iterable</span>
<span class="sd">            Iterable of values to be converted.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        v : list of values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">values</span></div>


    <span class="c1">###########################################################################</span>
    <span class="c1">### Sequence Access Iteration</span>

<div class="viewcode-block" id="CharacterMatrix.__iter__">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.__iter__">[docs]</a>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Returns an iterator over character map&#39;s ordered keys.&quot;</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">t</span></div>


    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span>

<div class="viewcode-block" id="CharacterMatrix.values">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.values">[docs]</a>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates values (i.e. sequences) in this matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="p">[</span><span class="n">t</span><span class="p">]</span></div>


    <span class="c1"># def iterkeys(self):</span>
    <span class="c1">#     &quot;Dictionary interface implementation for direct access to character map.&quot;</span>
    <span class="c1">#     for t in self.taxon_namespace:</span>
    <span class="c1">#         if t in self._taxon_sequence_map:</span>
    <span class="c1">#             yield t</span>

    <span class="c1"># def itervalues(self):</span>
    <span class="c1">#     &quot;Dictionary interface implementation for direct access to character map.&quot;</span>
    <span class="c1">#     for t in self.taxon_namespace:</span>
    <span class="c1">#         if t in self._taxon_sequence_map:</span>
    <span class="c1">#             yield self._taxon_sequence_map[t]</span>

<div class="viewcode-block" id="CharacterMatrix.items">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.items">[docs]</a>
    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Returns character map key, value pairs in key-order.&quot;</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">t</span><span class="p">]</span></div>


    <span class="c1"># def values(self):</span>
    <span class="c1">#     &quot;Returns list of values.&quot;</span>
    <span class="c1">#     return [self._taxon_sequence_map[t] for t in self.taxon_namespace if t in self._taxon_seq_map]</span>

    <span class="c1"># def pop(self, key, alt_val=None):</span>
    <span class="c1">#     &quot;a.pop(k[, x]):  a[k] if k in a, else x (and remove k)&quot;</span>
    <span class="c1">#     return self._taxon_sequence_map.pop(key, alt_val)</span>

    <span class="c1"># def popitem(self):</span>
    <span class="c1">#     &quot;a.popitem()  remove and last (key, value) pair&quot;</span>
    <span class="c1">#     return self._taxon_sequence_map.popitem()</span>

    <span class="c1"># def keys(self):</span>
    <span class="c1">#     &quot;Returns a copy of the ordered list of character map keys.&quot;</span>
    <span class="c1">#     return list(self._taxon_sequence_map.keys())</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Metrics</span>

<div class="viewcode-block" id="CharacterMatrix.__len__">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.__len__">[docs]</a>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of sequences in matrix.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        n : Number of sequences in matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_get_sequence_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of characters in *first* sequence in matrix.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        n : integer</span>
<span class="sd">            Number of sequences in matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="c1"># yuck, but len(self.values())</span>
            <span class="c1"># means we have to create and populate a list ...</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
    <span class="n">sequence_size</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_sequence_size</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">vector_size</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_sequence_size</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># legacy</span>

    <span class="k">def</span> <span class="nf">_get_max_sequence_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maximum number of characters across all sequences in matrix.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        n : integer</span>
<span class="sd">            Maximum number of characters across all sequences in matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_len</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">max_len</span><span class="p">:</span>
                <span class="n">max_len</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">max_len</span>
    <span class="n">max_sequence_size</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_max_sequence_size</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Mass/Bulk Operations</span>

<div class="viewcode-block" id="CharacterMatrix.fill">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.fill">[docs]</a>
    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pads out all sequences in ``self`` by adding ``value`` to each sequence</span>
<span class="sd">        until its length is ``size`` long or equal to the length of the longest</span>
<span class="sd">        sequence if ``size`` is not specified.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : object</span>
<span class="sd">            A valid value (e.g., a numeric value for continuous characters, or</span>
<span class="sd">            a |StateIdentity| for discrete character).</span>
<span class="sd">        size : integer or None</span>
<span class="sd">            The size (length) up to which the sequences will be padded. If |None|, then</span>
<span class="sd">            the maximum (longest) sequence size will be used.</span>
<span class="sd">        append : boolean</span>
<span class="sd">            If |True| (default), then new values will be added to the end of</span>
<span class="sd">            each sequence. If |False|, then new values will be inserted to the</span>
<span class="sd">            front of each sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_sequence_size</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">size</span></div>


<div class="viewcode-block" id="CharacterMatrix.fill_taxa">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.fill_taxa">[docs]</a>
    <span class="k">def</span> <span class="nf">fill_taxa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a new (empty) sequence for each |Taxon| instance in</span>
<span class="sd">        current taxon namespace that does not have a sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="n">CharacterDataSequence</span><span class="p">()</span></div>


<div class="viewcode-block" id="CharacterMatrix.pack">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.pack">[docs]</a>
    <span class="k">def</span> <span class="nf">pack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds missing sequences for all |Taxon| instances in current</span>
<span class="sd">        namespace, and then pads out all sequences in ``self`` by adding ``value``</span>
<span class="sd">        to each sequence until its length is ``size`` long or equal to the length</span>
<span class="sd">        of the longest sequence if ``size`` is not specified. A combination of</span>
<span class="sd">        :meth:`CharacterMatrix.fill_taxa()` and</span>
<span class="sd">        :meth:`CharacterMatrix.fill()`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : object</span>
<span class="sd">            A valid value (e.g., a numeric value for continuous characters, or</span>
<span class="sd">            a |StateIdentity| for discrete character).</span>
<span class="sd">        size : integer or None</span>
<span class="sd">            The size (length) up to which the sequences will be padded. If |None|, then</span>
<span class="sd">            the maximum (longest) sequence size will be used.</span>
<span class="sd">        append : boolean</span>
<span class="sd">            If |True| (default), then new values will be added to the end of</span>
<span class="sd">            each sequence. If |False|, then new values will be inserted to the</span>
<span class="sd">            front of each sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_taxa</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="n">append</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterMatrix.add_sequences">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.add_sequences">[docs]</a>
    <span class="k">def</span> <span class="nf">add_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds sequences for |Taxon| objects that are in ``other_matrix`` but not in</span>
<span class="sd">        ``self``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other_matrix : |CharacterMatrix|</span>
<span class="sd">            Matrix from which to add sequences.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">            1. ``other_matrix`` must be of same type as ``self``.</span>
<span class="sd">            2. ``other_matrix`` must have the same |TaxonNamespace| as ``self``.</span>
<span class="sd">            3. Each sequence associated with a |Taxon| reference in ``other_matrix``</span>
<span class="sd">               but not in ``self`` will be added to ``self`` as a shallow-copy.</span>
<span class="sd">            4. All other sequences will be ignored.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">TaxonNamespaceIdentityError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">character_sequence_type</span><span class="p">(</span><span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">])</span></div>


<div class="viewcode-block" id="CharacterMatrix.replace_sequences">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.replace_sequences">[docs]</a>
    <span class="k">def</span> <span class="nf">replace_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replaces sequences for |Taxon| objects shared between ``self`` and</span>
<span class="sd">        ``other_matrix``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other_matrix : |CharacterMatrix|</span>
<span class="sd">            Matrix from which to replace sequences.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">            1. ``other_matrix`` must be of same type as ``self``.</span>
<span class="sd">            2. ``other_matrix`` must have the same |TaxonNamespace| as ``self``.</span>
<span class="sd">            3. Each sequence in ``self`` associated with a |Taxon| that is</span>
<span class="sd">               also represented in ``other_matrix`` will be replaced with a</span>
<span class="sd">               shallow-copy of the corresponding sequence from ``other_matrix``.</span>
<span class="sd">            4. All other sequences will be ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">TaxonNamespaceIdentityError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">character_sequence_type</span><span class="p">(</span><span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">])</span></div>


<div class="viewcode-block" id="CharacterMatrix.update_sequences">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.update_sequences">[docs]</a>
    <span class="k">def</span> <span class="nf">update_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replaces sequences for |Taxon| objects shared between ``self`` and</span>
<span class="sd">        ``other_matrix`` and adds sequences for |Taxon| objects that are</span>
<span class="sd">        in ``other_matrix`` but not in ``self``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other_matrix : |CharacterMatrix|</span>
<span class="sd">            Matrix from which to update sequences.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">            1. ``other_matrix`` must be of same type as ``self``.</span>
<span class="sd">            2. ``other_matrix`` must have the same |TaxonNamespace| as ``self``.</span>
<span class="sd">            3. Each sequence associated with a |Taxon| reference in ``other_matrix``</span>
<span class="sd">               but not in ``self`` will be added to ``self``.</span>
<span class="sd">            4. Each sequence in ``self`` associated with a |Taxon| that is</span>
<span class="sd">               also represented in ``other_matrix`` will be replaced with a</span>
<span class="sd">               shallow-copy of the corresponding sequence from ``other_matrix``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">TaxonNamespaceIdentityError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">character_sequence_type</span><span class="p">(</span><span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">])</span></div>


<div class="viewcode-block" id="CharacterMatrix.extend_sequences">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.extend_sequences">[docs]</a>
    <span class="k">def</span> <span class="nf">extend_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">,</span> <span class="n">is_add_new_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extends sequences in ``self`` with characters associated with</span>
<span class="sd">        corresponding |Taxon| objects in ``other_matrix``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other_matrix : |CharacterMatrix|</span>
<span class="sd">            Matrix from which to extend sequences.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">            1. ``other_matrix`` must be of same type as ``self``.</span>
<span class="sd">            2. ``other_matrix`` must have the same |TaxonNamespace| as ``self``.</span>
<span class="sd">            3. Each sequence associated with a |Taxon| reference in</span>
<span class="sd">               ``other_matrix`` that is also in ``self`` will be appended to the</span>
<span class="sd">               sequence currently associated with that |Taxon| reference</span>
<span class="sd">               in ``self``.</span>
<span class="sd">            4. All other sequences will be ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">TaxonNamespaceIdentityError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_add_new_sequences</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">character_sequence_type</span><span class="p">(</span><span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">])</span></div>


<div class="viewcode-block" id="CharacterMatrix.extend_matrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.extend_matrix">[docs]</a>
    <span class="k">def</span> <span class="nf">extend_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extends sequences in ``self`` with characters associated with</span>
<span class="sd">        corresponding |Taxon| objects in ``other_matrix`` and adds</span>
<span class="sd">        sequences for |Taxon| objects that are in ``other_matrix`` but not</span>
<span class="sd">        in ``self``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other_matrix : |CharacterMatrix|</span>
<span class="sd">            Matrix from which to extend.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">            1. ``other_matrix`` must be of same type as ``self``.</span>
<span class="sd">            2. ``other_matrix`` must have the same |TaxonNamespace| as ``self``.</span>
<span class="sd">            3. Each sequence associated with a |Taxon| reference in ``other_matrix``</span>
<span class="sd">               that is also in ``self`` will be appending</span>
<span class="sd">               to the sequence currently associated with that |Taxon|</span>
<span class="sd">               reference in ``self``.</span>
<span class="sd">            4. Each sequence associated with a |Taxon| reference in</span>
<span class="sd">               ``other_matrix`` that is also in ``self`` will replace the sequence</span>
<span class="sd">               currently associated with that |Taxon| reference in ``self``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">TaxonNamespaceIdentityError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_matrix</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">character_sequence_type</span><span class="p">(</span><span class="n">other_matrix</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">])</span></div>


<div class="viewcode-block" id="CharacterMatrix.remove_sequences">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.remove_sequences">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taxa</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes sequences associated with |Taxon| instances specified in</span>
<span class="sd">        ``taxa``. A KeyError is raised if a |Taxon| instance is</span>
<span class="sd">        specified for which there is no associated sequences.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        taxa : iterable[|Taxon|]</span>
<span class="sd">            List or some other iterable of |Taxon| instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">taxa</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span></div>


<div class="viewcode-block" id="CharacterMatrix.discard_sequences">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.discard_sequences">[docs]</a>
    <span class="k">def</span> <span class="nf">discard_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taxa</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes sequences associated with |Taxon| instances specified in</span>
<span class="sd">        ``taxa`` if they exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        taxa : iterable[|Taxon|]</span>
<span class="sd">            List or some other iterable of |Taxon| instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">taxa</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span></div>


<div class="viewcode-block" id="CharacterMatrix.keep_sequences">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.keep_sequences">[docs]</a>
    <span class="k">def</span> <span class="nf">keep_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taxa</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Discards all sequences *not* associated with any of the |Taxon| instances.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        taxa : iterable[|Taxon|]</span>
<span class="sd">            List or some other iterable of |Taxon| instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_keep</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">taxa</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">to_keep</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span></div>


    <span class="c1"># def extend_characters(self, other_matrix):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     DEPRECATED</span>
    <span class="c1">#     Extends this matrix by adding characters from sequences of taxa</span>
    <span class="c1">#     in given matrix to sequences of taxa with correspond labels in</span>
    <span class="c1">#     this one. Taxa in the second matrix that do not exist in the</span>
    <span class="c1">#     current one are ignored.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     self._taxon_sequence_map.extend_characters(other_matrix.taxon_seq_map)</span>

    <span class="c1"># def extend_map(self,</span>
    <span class="c1">#                   other_map,</span>
    <span class="c1">#                   overwrite_existing=False,</span>
    <span class="c1">#                   extend_existing=False):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     DEPRECATED</span>
    <span class="c1">#     Extends this matrix by adding taxa and characters from the given</span>
    <span class="c1">#     map to this one.  If ``overwrite_existing`` is True and a taxon</span>
    <span class="c1">#     in the other map is already present in the current one, then</span>
    <span class="c1">#     the sequence associated with the taxon in the second map</span>
    <span class="c1">#     replaces the sequence in the current one. If ``extend_existing``</span>
    <span class="c1">#     is True and a taxon in the other matrix is already present in</span>
    <span class="c1">#     the current one, then the squence map with the taxon in</span>
    <span class="c1">#     the second map will be added to the sequence in the current</span>
    <span class="c1">#     one. If both are True, then an exception is raised. If neither</span>
    <span class="c1">#     are True,  and a taxon in the other map is already present in</span>
    <span class="c1">#     the current one, then the sequence is ignored.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     self._taxon_sequence_map.extend(other_map,</span>
    <span class="c1">#         overwrite_existing=overwrite_existing,</span>
    <span class="c1">#         extend_existing=extend_existing)</span>
    <span class="c1">#     self.update_taxon_namespace()</span>

    <span class="c1"># def extend(self,</span>
    <span class="c1">#            other_matrix,</span>
    <span class="c1">#            overwrite_existing=False,</span>
    <span class="c1">#            extend_existing=False):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Extends this matrix by adding taxa and characters from the given</span>
    <span class="c1">#     matrix to this one.  If ``overwrite_existing`` is True and a taxon</span>
    <span class="c1">#     in the other matrix is already present in the current one, then</span>
    <span class="c1">#     the sequence associated with the taxon in the second matrix</span>
    <span class="c1">#     replaces the sequence in the current one. If ``extend_existing``</span>
    <span class="c1">#     is True and a taxon in the other matrix is already present in</span>
    <span class="c1">#     the current one, then the sequence associated with the taxon in</span>
    <span class="c1">#     the second matrix will be added to the sequence in the current</span>
    <span class="c1">#     one. If both are True, then an exception is raised. If neither</span>
    <span class="c1">#     are True, and a taxon in the other matrix is already present in</span>
    <span class="c1">#     the current one, then the sequence is ignored.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     self._taxon_sequence_map.extend(other_matrix.taxon_seq_map,</span>
    <span class="c1">#         overwrite_existing=overwrite_existing,</span>
    <span class="c1">#         extend_existing=extend_existing)</span>
    <span class="c1">#     self.update_taxon_namespace()</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Character Subset Management</span>

<div class="viewcode-block" id="CharacterMatrix.add_character_subset">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.add_character_subset">[docs]</a>
    <span class="k">def</span> <span class="nf">add_character_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char_subset</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a CharacterSubset object. Raises an error if one already exists</span>
<span class="sd">        with the same label.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">char_subset</span><span class="o">.</span><span class="n">label</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">character_subsets</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Character subset &#39;</span><span class="si">%s</span><span class="s2">&#39; already defined&quot;</span> <span class="o">%</span> <span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">character_subsets</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">char_subset</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">character_subsets</span><span class="p">[</span><span class="n">label</span><span class="p">]</span></div>


<div class="viewcode-block" id="CharacterMatrix.new_character_subset">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.new_character_subset">[docs]</a>
    <span class="k">def</span> <span class="nf">new_character_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">character_indices</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines a set of character (columns) that make up a character set.</span>
<span class="sd">        Raises an error if one already exists with the same label. Column</span>
<span class="sd">        indices are 0-based.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">CharacterSubset</span><span class="p">(</span><span class="n">character_indices</span><span class="o">=</span><span class="n">character_indices</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_character_subset</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span></div>


    <span class="c1">###########################################################################</span>
    <span class="c1">### CharacterType Management</span>

    <span class="k">def</span> <span class="nf">new_character_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">CharacterType</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">### Export</span>

<div class="viewcode-block" id="CharacterMatrix.export_character_subset">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.export_character_subset">[docs]</a>
    <span class="k">def</span> <span class="nf">export_character_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">character_subset</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a new CharacterMatrix (of the same type) consisting only</span>
<span class="sd">        of columns given by the CharacterSubset, ``character_subset``.</span>
<span class="sd">        Note that this new matrix will still reference the same taxon set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">textprocessing</span><span class="o">.</span><span class="n">is_str_type</span><span class="p">(</span><span class="n">character_subset</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">character_subset</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">character_subsets</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">character_subset</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">character_subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">character_subsets</span><span class="p">[</span><span class="n">character_subset</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_character_indices</span><span class="p">(</span><span class="n">character_subset</span><span class="o">.</span><span class="n">character_indices</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterMatrix.export_character_indices">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.export_character_indices">[docs]</a>
    <span class="k">def</span> <span class="nf">export_character_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a new CharacterMatrix (of the same type) consisting only</span>
<span class="sd">        of columns given by the 0-based indices in ``indices``.</span>
<span class="sd">        Note that this new matrix will still reference the same taxon set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># clear out character subsets; otherwise all indices will have to be</span>
        <span class="c1"># recalculated, which will require some careful and perhaps arbitrary</span>
        <span class="c1"># handling of corner cases</span>
        <span class="n">clone</span><span class="o">.</span><span class="n">character_subsets</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">OrderedCaselessDict</span><span class="p">()</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">clone</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">cell_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">cell_idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                    <span class="k">del</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">cell_idx</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">clone</span></div>


    <span class="c1">###########################################################################</span>
    <span class="c1">### Representation</span>

<div class="viewcode-block" id="CharacterMatrix.description">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.CharacterMatrix.description">[docs]</a>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">itemize</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns description of object, up to level ``depth``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">output_strio</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot; (</span><span class="si">%s</span><span class="s2">: &#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="n">output_strio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s%s</span><span class="s1"> object at </span><span class="si">%s%s</span><span class="s1">&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">indent</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">,</span>
                   <span class="n">itemize</span><span class="p">,</span>
                   <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                   <span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)),</span>
                   <span class="n">label</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">output_strio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:  </span><span class="si">%d</span><span class="s1"> Sequences&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">tlead</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">[Taxon Set]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">indent</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span>
                    <span class="n">output_strio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tlead</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="o">.</span><span class="n">description</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="n">itemize</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output_strio</span><span class="p">)</span>
                <span class="n">tlead</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">[Characters]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">indent</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span>
                <span class="n">output_strio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tlead</span><span class="p">)</span>
                <span class="n">indent</span> <span class="o">+=</span> <span class="mi">8</span>
                <span class="n">maxlabel</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">):</span>
                    <span class="n">output_strio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1"> characters</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">%</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span><span class="p">,</span>
                           <span class="s2">&quot;[</span><span class="si">%d</span><span class="s2">] &quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span>
                           <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">),</span>
                           <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">[</span><span class="n">t</span><span class="p">])))</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">output_strio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span></div>


    <span class="c1">###########################################################################</span>
    <span class="c1">### Legacy</span>

    <span class="k">def</span> <span class="nf">_get_taxon_seq_map</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;All methods and features of &#39;CharacterMatrix.taxon_seq_map&#39; have been integrated directly into &#39;CharacterMatrix&#39;, or otherwise replaced entirely&quot;</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="n">taxon_seq_map</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_taxon_seq_map</span><span class="p">)</span></div>


<span class="c1">###############################################################################</span>
<span class="c1">## Specialized Matrices</span>

<span class="c1">### Continuous Characters ##################################################</span>

<span class="k">class</span> <span class="nc">ContinuousCharacterDataSequence</span><span class="p">(</span><span class="n">CharacterDataSequence</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A sequence of continuous character values for a particular taxon or entry</span>
<span class="sd">    in a data matrix. Specializes `CharacterDataSequence` by assuming all</span>
<span class="sd">    values are primitive numerics (i.e., either floats or integers) when</span>
<span class="sd">    copying or representing self.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">symbols_as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of string representation of values of this vector.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        v : list</span>
<span class="sd">            List of string representation of values making up this vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">symbols_as_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
        <span class="c1"># different default</span>
        <span class="k">return</span> <span class="n">CharacterDataSequence</span><span class="o">.</span><span class="n">symbols_as_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>

<div class="viewcode-block" id="ContinuousCharacterMatrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.ContinuousCharacterMatrix">[docs]</a>
<span class="k">class</span> <span class="nc">ContinuousCharacterMatrix</span><span class="p">(</span><span class="n">CharacterMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specializes |CharacterMatrix| for continuous data.</span>

<span class="sd">    Sequences stored using |ContinuousCharacterDataSequence|, with values of</span>
<span class="sd">    elements assumed to be ``float`` .</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">ContinuousCharacterDataSequence</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;continuous&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">CharacterMatrix</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<span class="c1">### Discrete Characters ##################################################</span>

<span class="k">class</span> <span class="nc">DiscreteCharacterDataSequence</span><span class="p">(</span><span class="n">CharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">DiscreteCharacterMatrix</span><span class="p">(</span><span class="n">CharacterMatrix</span><span class="p">):</span>

    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">DiscreteCharacterDataSequence</span>

    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;discrete&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">CharacterMatrix</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_alphabets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_state_alphabet</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_get_default_state_alphabet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_state_alphabet</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_state_alphabet</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state_alphabets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_alphabets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state_alphabets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Multiple state alphabets defined for this matrix with no default specified&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state_alphabets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;No state alphabets defined for this matrix&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">def</span> <span class="nf">_set_default_state_alphabet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_alphabets</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_alphabets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_state_alphabet</span> <span class="o">=</span> <span class="n">s</span>
    <span class="n">default_state_alphabet</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_default_state_alphabet</span><span class="p">,</span> <span class="n">_set_default_state_alphabet</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">append_taxon_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taxon</span><span class="p">,</span> <span class="n">state_symbols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span> <span class="o">=</span> <span class="n">CharacterDataSequence</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">state_symbols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">textprocessing</span><span class="o">.</span><span class="n">is_str_type</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">symbol</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">symbol</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">taxon</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_symbol_state_map</span><span class="p">[</span><span class="n">symbol</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">remap_to_state_alphabet_by_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">state_alphabet</span><span class="p">,</span>
            <span class="n">purge_other_state_alphabets</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        All entities with any reference to a state alphabet will be have the</span>
<span class="sd">        reference reassigned to state alphabet ``sa``, and all entities with</span>
<span class="sd">        any reference to a state alphabet element will be have the reference</span>
<span class="sd">        reassigned to any state alphabet element in ``sa`` that has the same</span>
<span class="sd">        symbol. Raises KeyError if no matching symbol can be found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">vi</span><span class="p">,</span> <span class="n">vec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">for</span> <span class="n">ci</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vec</span><span class="p">):</span>
                <span class="n">vec</span><span class="p">[</span><span class="n">ci</span><span class="p">]</span> <span class="o">=</span> <span class="n">state_alphabet</span><span class="p">[</span><span class="n">cell</span><span class="o">.</span><span class="n">symbol</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">character_types</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ct</span><span class="o">.</span><span class="n">state_alphabet</span> <span class="o">=</span> <span class="n">state_alphabet</span>
        <span class="k">if</span> <span class="n">purge_other_state_alphabets</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_state_alphabet</span> <span class="o">=</span> <span class="n">state_alphabet</span>

    <span class="k">def</span> <span class="nf">remap_to_default_state_alphabet_by_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">purge_other_state_alphabets</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        All entities with any reference to a state alphabet will be have the</span>
<span class="sd">        reference reassigned to the default state alphabet, and all entities</span>
<span class="sd">        with any reference to a state alphabet element will be have the</span>
<span class="sd">        reference reassigned to any state alphabet element in the default</span>
<span class="sd">        state alphabet that has the same symbol. Raises ValueError if no</span>
<span class="sd">        matching symbol can be found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remap_to_state_alphabet_by_symbol</span><span class="p">(</span>
                <span class="n">state_alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_state_alphabet</span><span class="p">,</span>
                <span class="n">purge_other_state_alphabets</span><span class="o">=</span><span class="n">purge_other_state_alphabets</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">taxon_state_sets_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">char_indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">gaps_as_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">gap_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">no_data_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary that maps taxon objects to lists of sets of</span>
<span class="sd">        fundamental state indices.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        char_indices : iterable of ints</span>
<span class="sd">            An iterable of indexes of characters to include (by column). If not</span>
<span class="sd">            given or |None| [default], then all characters are included.</span>

<span class="sd">        gaps_as_missing : boolean</span>
<span class="sd">            If |True| [default] then gap characters will be treated as missing</span>
<span class="sd">            data values. If |False|, then they will be treated as an additional</span>
<span class="sd">            (fundamental) state.`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : dict</span>
<span class="sd">            A dictionary with class:|Taxon| objects as keys and a list of sets</span>
<span class="sd">            of fundamental state indexes as values.</span>

<span class="sd">            E.g., Given the following matrix of DNA characters:</span>

<span class="sd">                T1 AGN</span>
<span class="sd">                T2 C-T</span>
<span class="sd">                T3 GC?</span>

<span class="sd">            Return with ``gaps_as_missing==True`` ::</span>

<span class="sd">                {</span>
<span class="sd">                    &lt;T1&gt; : [ set([0]), set([2]),        set([0,1,2,3]) ],</span>
<span class="sd">                    &lt;T2&gt; : [ set([1]), set([0,1,2,3]),  set([3]) ],</span>
<span class="sd">                    &lt;T3&gt; : [ set([2]), set([1]),        set([0,1,2,3]) ],</span>
<span class="sd">                }</span>

<span class="sd">            Return with ``gaps_as_missing==False`` ::</span>

<span class="sd">                {</span>
<span class="sd">                    &lt;T1&gt; : [ set([0]), set([2]),        set([0,1,2,3]) ],</span>
<span class="sd">                    &lt;T2&gt; : [ set([1]), set([4]),        set([3]) ],</span>
<span class="sd">                    &lt;T3&gt; : [ set([2]), set([1]),        set([0,1,2,3,4]) ],</span>
<span class="sd">                }</span>

<span class="sd">            Note that when gaps are treated as a fundamental state, not only</span>
<span class="sd">            does &#39;-&#39; map to a distinct and unique state (4), but &#39;?&#39; (missing</span>
<span class="sd">            data) maps to set consisting of all bases *and* the gap</span>
<span class="sd">            state, whereas &#39;N&#39; maps to a set of all bases but not including the</span>
<span class="sd">            gap state.</span>

<span class="sd">            When gaps are treated as missing, on the other hand, then &#39;?&#39; and</span>
<span class="sd">            &#39;N&#39; and &#39;-&#39; all map to the same set, i.e. of all the bases.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">taxon_to_state_indices</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">cdv</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">char_indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ci</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cdv</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ci</span> <span class="o">=</span> <span class="n">char_indices</span>
            <span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">char_index</span> <span class="ow">in</span> <span class="n">ci</span><span class="p">:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">cdv</span><span class="p">[</span><span class="n">char_index</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">gaps_as_missing</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">fundamental_indexes_with_gaps_as_missing</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">fundamental_indexes</span><span class="p">))</span>
            <span class="n">taxon_to_state_indices</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">taxon_to_state_indices</span>

    <span class="k">def</span> <span class="nf">folded_site_frequency_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_pad_vector_to_unfolded_length</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the folded or minor site/allele frequency spectrum.</span>

<span class="sd">        Given $N$ chromosomes, the site frequency spectrum is a vector $(f_0,</span>
<span class="sd">        f_1, f_2, ..., f_N)$, where the value $f_i$ is the number of</span>
<span class="sd">        sites where $i$ derived alleles are segregating in the sample: 0</span>
<span class="sd">        alleles, 1 allele, 2 alleles, etc.</span>

<span class="sd">        The *folded* site frequency spectrum is a vector $(f_0, f_1, f_2, ...,</span>
<span class="sd">        f_m), m = \ceil{\frac{N}{2}}$, where the values are the number of minor</span>
<span class="sd">        alleles in the site.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        is_pad_vector_to_unfolded_length: bool</span>
<span class="sd">            If False, then the vector length will be $\ceil{\frac{N}{2}}$,</span>
<span class="sd">            where $N$ is the number of taxa. Otherwise, by default,</span>
<span class="sd">            True, length of vector will be number of taxa + 1, with the</span>
<span class="sd">            first element the number of monomorphic sites not contributing to</span>
<span class="sd">            the site frequency spectrum.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        v : list[int]</span>
<span class="sd">            A vector of integers representing the folded site frequency</span>
<span class="sd">            spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">site_columns</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">())</span>
        <span class="n">nsites</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">is_pad_vector_to_unfolded_length</span><span class="p">:</span>
            <span class="n">sfs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sfs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_taxon_sequence_map</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">site_columns</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
            <span class="n">nsites</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">del</span> <span class="n">counter</span><span class="p">[</span><span class="n">counter</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">sfs</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">counter</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sfs</span><span class="p">)</span> <span class="o">==</span> <span class="n">nsites</span>
        <span class="k">return</span> <span class="n">sfs</span>

<span class="c1">### Fixed Alphabet Characters ##################################################</span>

<span class="k">class</span> <span class="nc">FixedAlphabetCharacterDataSequence</span><span class="p">(</span><span class="n">CharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">FixedAlphabetCharacterMatrix</span><span class="p">(</span><span class="n">DiscreteCharacterMatrix</span><span class="p">):</span>

    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">FixedAlphabetCharacterDataSequence</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;fixed&quot;</span>
    <span class="n">datatype_alphabet</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">DiscreteCharacterMatrix</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_alphabets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">datatype_alphabet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_state_alphabet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">datatype_alphabet</span>

    <span class="k">def</span> <span class="nf">coerce_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype_alphabet</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;datatype_alphabet&#39; not set&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">charstatemodel</span><span class="o">.</span><span class="n">coerce_to_state_identities</span><span class="p">(</span>
                <span class="n">state_alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">datatype_alphabet</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>

<span class="c1">### DNA Characters ##################################################</span>

<span class="k">class</span> <span class="nc">DnaCharacterDataSequence</span><span class="p">(</span><span class="n">FixedAlphabetCharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="DnaCharacterMatrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.DnaCharacterMatrix">[docs]</a>
<span class="k">class</span> <span class="nc">DnaCharacterMatrix</span><span class="p">(</span><span class="n">FixedAlphabetCharacterMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specializes |CharacterMatrix| for DNA data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">DnaCharacterDataSequence</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;dna&quot;</span>
    <span class="n">datatype_alphabet</span> <span class="o">=</span> <span class="n">DNA_STATE_ALPHABET</span></div>


<span class="c1">### RNA Characters ##################################################</span>

<span class="k">class</span> <span class="nc">RnaCharacterDataSequence</span><span class="p">(</span><span class="n">FixedAlphabetCharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="RnaCharacterMatrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.RnaCharacterMatrix">[docs]</a>
<span class="k">class</span> <span class="nc">RnaCharacterMatrix</span><span class="p">(</span><span class="n">FixedAlphabetCharacterMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specializes |CharacterMatrix| for DNA data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">RnaCharacterDataSequence</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;rna&quot;</span>
    <span class="n">datatype_alphabet</span> <span class="o">=</span> <span class="n">RNA_STATE_ALPHABET</span></div>


<span class="c1">### Nucleotide Characters ##################################################</span>

<span class="k">class</span> <span class="nc">NucleotideCharacterDataSequence</span><span class="p">(</span><span class="n">FixedAlphabetCharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">NucleotideCharacterMatrix</span><span class="p">(</span><span class="n">FixedAlphabetCharacterMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specializes |CharacterMatrix| for RNA data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">NucleotideCharacterDataSequence</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;nucleotide&quot;</span>
    <span class="n">datatype_alphabet</span> <span class="o">=</span> <span class="n">NUCLEOTIDE_STATE_ALPHABET</span>

<span class="c1">### Protein Characters ##################################################</span>

<span class="k">class</span> <span class="nc">ProteinCharacterDataSequence</span><span class="p">(</span><span class="n">FixedAlphabetCharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="ProteinCharacterMatrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.ProteinCharacterMatrix">[docs]</a>
<span class="k">class</span> <span class="nc">ProteinCharacterMatrix</span><span class="p">(</span><span class="n">FixedAlphabetCharacterMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specializes |CharacterMatrix| for protein or amino acid data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">ProteinCharacterDataSequence</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;protein&quot;</span>
    <span class="n">datatype_alphabet</span> <span class="o">=</span> <span class="n">PROTEIN_STATE_ALPHABET</span></div>


<span class="c1">### Restricted Site Characters ##################################################</span>

<span class="k">class</span> <span class="nc">RestrictionSitesCharacterDataSequence</span><span class="p">(</span><span class="n">FixedAlphabetCharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="RestrictionSitesCharacterMatrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.RestrictionSitesCharacterMatrix">[docs]</a>
<span class="k">class</span> <span class="nc">RestrictionSitesCharacterMatrix</span><span class="p">(</span><span class="n">FixedAlphabetCharacterMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specializes |CharacterMatrix| for restriction site data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">RestrictionSitesCharacterDataSequence</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;restriction&quot;</span>
    <span class="n">datatype_alphabet</span> <span class="o">=</span> <span class="n">RESTRICTION_SITES_STATE_ALPHABET</span></div>


<span class="c1">### Infinite Sites Characters ##################################################</span>

<span class="k">class</span> <span class="nc">InfiniteSitesCharacterDataSequence</span><span class="p">(</span><span class="n">FixedAlphabetCharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="InfiniteSitesCharacterMatrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.InfiniteSitesCharacterMatrix">[docs]</a>
<span class="k">class</span> <span class="nc">InfiniteSitesCharacterMatrix</span><span class="p">(</span><span class="n">FixedAlphabetCharacterMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specializes |CharacterMatrix| for infinite sites data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">InfiniteSitesCharacterDataSequence</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;infinite&quot;</span>
    <span class="n">datatype_alphabet</span> <span class="o">=</span> <span class="n">INFINITE_SITES_STATE_ALPHABET</span></div>


<span class="c1">### Standard Characters ##################################################</span>

<span class="k">class</span> <span class="nc">StandardCharacterDataSequence</span><span class="p">(</span><span class="n">DiscreteCharacterDataSequence</span><span class="p">):</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="StandardCharacterMatrix">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.StandardCharacterMatrix">[docs]</a>
<span class="k">class</span> <span class="nc">StandardCharacterMatrix</span><span class="p">(</span><span class="n">DiscreteCharacterMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specializes |CharacterMatrix| for &quot;standard&quot; data (i.e., generic discrete</span>
<span class="sd">    character data).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">character_sequence_type</span> <span class="o">=</span> <span class="n">StandardCharacterDataSequence</span>

    <span class="n">data_type</span> <span class="o">=</span> <span class="s2">&quot;standard&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A default state alphabet consisting of state symbols of 0-9 will</span>
<span class="sd">        automatically be created unless the ``default_state_alphabet=None`` is</span>
<span class="sd">        passed in. To specify a different default state alphabet::</span>

<span class="sd">            default_state_alphabet=dendropy.new_standard_state_alphabet(&quot;abc&quot;)</span>
<span class="sd">            default_state_alphabet=dendropy.new_standard_state_alphabet(&quot;ij&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;default_state_alphabet&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">default_state_alphabet</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;default_state_alphabet&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">default_state_alphabet</span> <span class="o">=</span> <span class="n">charstatemodel</span><span class="o">.</span><span class="n">new_standard_state_alphabet</span><span class="p">()</span>
        <span class="n">DiscreteCharacterMatrix</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">default_state_alphabet</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_state_alphabet</span> <span class="o">=</span> <span class="n">default_state_alphabet</span>

<div class="viewcode-block" id="StandardCharacterMatrix.coerce_values">
<a class="viewcode-back" href="../../../library/charmatrixmodel.html#dendropy.datamodel.charmatrixmodel.StandardCharacterMatrix.coerce_values">[docs]</a>
    <span class="k">def</span> <span class="nf">coerce_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_state_alphabet</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;default_state_alphabet&#39; not set&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">charstatemodel</span><span class="o">.</span><span class="n">coerce_to_state_identities</span><span class="p">(</span>
                <span class="n">state_alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_state_alphabet</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span></div>
</div>



<span class="c1">###############################################################################</span>
<span class="c1">## Main Character Matrix Factory Function</span>

<span class="n">data_type_matrix_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;continuous&#39;</span> <span class="p">:</span> <span class="n">ContinuousCharacterMatrix</span><span class="p">,</span>
    <span class="s1">&#39;dna&#39;</span> <span class="p">:</span> <span class="n">DnaCharacterMatrix</span><span class="p">,</span>
    <span class="s1">&#39;rna&#39;</span> <span class="p">:</span> <span class="n">RnaCharacterMatrix</span><span class="p">,</span>
    <span class="s1">&#39;nucleotide&#39;</span> <span class="p">:</span> <span class="n">NucleotideCharacterMatrix</span><span class="p">,</span>
    <span class="s1">&#39;protein&#39;</span> <span class="p">:</span> <span class="n">ProteinCharacterMatrix</span><span class="p">,</span>
    <span class="s1">&#39;standard&#39;</span> <span class="p">:</span> <span class="n">StandardCharacterMatrix</span><span class="p">,</span>
    <span class="s1">&#39;restriction&#39;</span> <span class="p">:</span> <span class="n">RestrictionSitesCharacterMatrix</span><span class="p">,</span>
    <span class="s1">&#39;infinite&#39;</span> <span class="p">:</span> <span class="n">InfiniteSitesCharacterMatrix</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">get_char_matrix_type</span><span class="p">(</span><span class="n">data_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;data_type&#39; must be specified&quot;</span><span class="p">)</span>
    <span class="n">matrix_type</span> <span class="o">=</span> <span class="n">data_type_matrix_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">matrix_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Unrecognized data type specification: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span>
            <span class="nb">sorted</span><span class="p">(</span><span class="n">data_type_matrix_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
    <span class="k">return</span> <span class="n">matrix_type</span>

<span class="k">def</span> <span class="nf">new_char_matrix</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">matrix_type</span> <span class="o">=</span> <span class="n">get_char_matrix_type</span><span class="p">(</span><span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">matrix_type</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div style="text-align: center; padding-top: 20px; padding-bottom: 5px; width: 100%;">
    <a href="../../../index.html"><img src="../../../_static/dendropy_logo.png" /></a>
</div><div style="clear:both; width: 100%; height:1px;"></div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div style="clear:both; width: 100%; height:1px;"></div><div style="clear:both; width: 100%; height:1px;"></div><div style="clear:both; width: 100%; height:1px;"></div>
    <!-- Documentation -->
    <div style="border-top: double 1px white; padding-top: 10px;">
        <h3>Documentation</h3>
        <ul>
            <li><a href="../../../primer/downloading.html">Downloading and Installing DendroPy</a></li>
            <li><a href="../../../primer/index.html">The DendroPy Primer</a></li>
            <li><a href="../../../library/index.html">Library API Reference</a></li>
            <li>
                <a href="../../../schemas/index.html">Schemas</a>
                <ul>
                    <li><a href="../../../schemas/fasta.html">FASTA</a></li>
                    <li><a href="../../../schemas/newick.html">Newick</a></li>
                    <li><a href="../../../schemas/nexml.html">NeXML</a></li>
                    <li><a href="../../../schemas/nexus.html">Nexus</a></li>
                    <li><a href="../../../schemas/phylip.html">PHYLIP</a></li>
                </ul>
            </li>
            <li>
                <a href="../../../programs/index.html">Programs</a>
                <ul>
                    <li><a href="../../../programs/sumtrees.html">SumTrees</a></li>
                </ul>
            </li>
            <li><a href="../../../glossary.html">Glossary and Terminological Reference</a></li>
            <li><a href="../../../developer.html">Developer Guide</a></li>
            <li><a href="../../../planning.html">Ongoing Development</a></li>
            <li><a href="../../../changes.html">Change History</a></li>
        </ul>
    </div>

    <!-- Downloads -->
    <div style="border-top: double 1px white; padding-top: 10px;">
        <h3>Obtaining</h3>
        <ul>
            <li><a target="_blank" href="http://pypi.python.org/pypi/DendroPy">Install from the Python Package Index</a></li>
            <li><a target="_blank" href="http://pypi.python.org/packages/source/D/DendroPy/DendroPy-5.0.4.tar.gz">Download the Source Code Archive</a></li>
            <li><a target="_blank" href="http://github.com/jeetsukumaran/DendroPy">Clone the Source Code Repository</a></li>
        </ul>
    </div>

    <!-- Discussions -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative;">
        <h3><span style="text-align: left">Discussion</span><span style="position: absolute; right: 0; top: 10px "><img src="../../../_static/google-groups-logo1.png" height="20px" alt="Google Groups" /></span></h3>
        <div style="margin-top: 15px;">
            <p style="font-size: 90%; margin-top: 3px; clear: both;">Join the <a href="http://groups.google.com/group/dendropy-users?hl=en">&quot; DendroPy Users&quot; </a>group to follow and participate in discussion, troubleshooting, help, information, suggestions, etc. on the usage and development of the DendroPy phylogenetic computing library.</p>
            <form action="http://groups.google.com/group/dendropy-users/boxsubscribe">
                <input type=text name=email>
                <input type=submit name="sub" value="Subscribe">
            </form>
            <p style="font-size: 90%; clear: both; padding-top: 5px; padding-bottom: 10px;">Enter your e-mail address in the box above and click the &quot;subscribe&quot; button to subscribe to the <a href="http://groups.google.com/group/dendropy-users?hl=en">&quot;dendropy-users&quot;</a> group, or click <a href="http://groups.google.com/group/dendropy-users?hl=en">here</a> to visit this group page directly.</p>
        </div>
    </div>

    <!-- Announcements -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative;">
        <h3><span style="text-align: left">Announcements</span><span style="position: absolute; right: 0; top: 10px "><img src="../../../_static/google-groups-logo1.png" height="20px" alt="Google Groups" /></span></h3>
        <div style="margin-top: 15px;">
            <p style="font-size: 90%; margin-top: 3px; clear: both;">Join the <a href="http://groups.google.com/group/dendropy-announce?hl=en">&quot; DendroPy Announcements&quot; </a>group to receive announcements of new releases, updates, changes and other news of interest to DendroPy users and developers.</p>
            <form action="http://groups.google.com/group/dendropy-announce/boxsubscribe">
                <input type=text name=email>
                <input type=submit name="sub" value="Subscribe">
            </form>
            <p style="font-size: 90%; clear: both; padding-top: 5px; padding-bottom: 10px;">Enter your e-mail address in the box above and click the &quot;subscribe&quot; button to subscribe to the <a href="http://groups.google.com/group/dendropy-announce?hl=en">&quot; dendropy-announce&quot; </a>group, or click <a href="http://groups.google.com/group/dendropy-announce?hl=en">here</a> to visit this group page directly.</p>
        </div>
    </div>

    <!-- Development -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative; padding-bottom: 15px; margin-bottom:5px;">
        <h3><span style="text-align: left"><a href="https://github.com/jeetsukumaran/DendroPy/">Development</a></span><a href="https://github.com/jeetsukumaran/DendroPy/"><span style="position: absolute; right: 0; top: 10px "><img src="../../../_static/Octocat.png" height="30px" alt="GitHub" /></span></a></h3>
        <div style="margin-top: 15px;">
            <!-- <a href="https://github.com/jeetsukumaran/DendroPy/issues">Issues</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/subscription">Watch</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/fork">Fork</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/stargazers">Star</a> &bull; <a href="https://github.com/jeetsukumaran/">Follow</a> -->
            <ul>
                <li>                <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/issues"><code>Issues</code></a></span> <span style="font-style: italic; font-size:80%;"> - Report bugs or request features</span></li>
                <li>     <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/subscription"><code>&nbsp;Watch</code></a></span> <span style="font-style: italic; font-size:80%;"> - Follow development activity</span></li>
                <li>        <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/fork"><code>&nbsp;&nbsp;Fork</code></a></span> <span style="font-style: italic; font-size:80%;"> - Contribute and collaborate</span></li>
                <li>  <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/stargazers"><code>&nbsp;&nbsp;Star</code></a></span> <span style="font-style: italic; font-size:80%;"> - Throw some glitter, add some glamour</span></li>
        </div>
    </div>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DendroPy 5.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">dendropy.datamodel.charmatrixmodel</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2009-2025, Jeet Sukumaran and Mark T. Holder.
    </div>
  </body>
</html>