<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Trees &#8212; DendroPy 5.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/rtd.css?v=cedc6a2f" />
    
    <script src="../_static/documentation_options.js?v=5df4c8d1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Collections of Trees" href="treecollections.html" />
    <link rel="prev" title="Partitions of Taxon Sets" href="taxa_partitions.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="treecollections.html" title="Collections of Trees"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="taxa_partitions.html" title="Partitions of Taxon Sets"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DendroPy 5.0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">The DendroPy Primer</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Trees</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="trees">
<h1>Trees<a class="headerlink" href="#trees" title="Link to this heading">¶</a></h1>
<section id="the-tree-class">
<h2>The <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> Class<a class="headerlink" href="#the-tree-class" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="../glossary.html#term-tree"><span class="xref std std-term">Trees</span></a> in DendroPy are represented by objects of the class <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>.
<a class="reference internal" href="../glossary.html#term-tree"><span class="xref std std-term">Trees</span></a> consist of a collection of <a class="reference internal" href="../glossary.html#term-node"><span class="xref std std-term">nodes</span></a>, represented by objects of the class <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>, connected to each other in parent-child or ancestor-descendent relationships by objects of the class <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a>.
The first or initial <a class="reference internal" href="../glossary.html#term-node"><span class="xref std std-term">node</span></a> of a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> is the head of the data structure, and is represented by the <code class="xref py py-attr docutils literal notranslate"><span class="pre">seed_node</span></code> attribute of a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object.
If the tree is <a class="reference internal" href="../glossary.html#term-rooted-tree"><span class="xref std std-term">rooted</span></a>, then this is the <a class="reference internal" href="../glossary.html#term-root-node"><span class="xref std std-term">root node</span></a>.
If the tree is <a class="reference internal" href="../glossary.html#term-unrooted-tree"><span class="xref std std-term">unrooted</span></a>, however, then this is an artificial node that <em>only</em> serves as the initial node when iterating over a tree in <a class="reference internal" href="../glossary.html#term-preorder-traversal"><span class="xref std std-term">preorder</span></a> or the final node when iterating over the tree in <a class="reference internal" href="../glossary.html#term-postorder-traversal"><span class="xref std std-term">postorder</span></a>, but does not have any informational significance by itself: it is an algorithmic artifact.</p>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">seed_node</span></code> attribute of a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object, like every other node on the tree, is an object of the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> class.
Every <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object maintains a list of its immediate child <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> objects as well as a reference to its parent <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object.
You can iterate over the <a class="reference internal" href="../glossary.html#term-child-node"><span class="xref std std-term">child</span></a> of a particular <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object using the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.child_node_iter" title="dendropy.datamodel.treemodel.Node.child_node_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">child_node_iter</span></code></a> method, get a shallow-copy list of child <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> objects using the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.child_nodes" title="dendropy.datamodel.treemodel.Node.child_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">child_nodes</span></code></a> method, or access the <a class="reference internal" href="../glossary.html#term-parent-node"><span class="xref std std-term">parent</span></a> <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object directly through the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.parent_node" title="dendropy.datamodel.treemodel.Node.parent_node"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parent_node</span></code></a> attribute of the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>.
By definition, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">seed_node</span></code> has no <a class="reference internal" href="../glossary.html#term-parent-node"><span class="xref std std-term">parent node</span></a>, <a class="reference internal" href="../glossary.html#term-leaf-node"><span class="xref std std-term">leaf nodes</span></a> have no <a class="reference internal" href="../glossary.html#term-child-node"><span class="xref std std-term">child nodes</span></a>, and term:<a class="reference internal" href="../glossary.html#term-internal-node"><code class="xref any std std-term docutils literal notranslate"><span class="pre">internal</span> <span class="pre">nodes</span></code></a> have both <a class="reference internal" href="../glossary.html#term-parent-node"><span class="xref std std-term">parent nodes</span></a> and <a class="reference internal" href="../glossary.html#term-child-node"><span class="xref std std-term">child nodes</span></a>.</p>
<p>Every <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object has an attribute, <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.edge" title="dendropy.datamodel.treemodel.Node.edge"><code class="xref py py-attr docutils literal notranslate"><span class="pre">edge</span></code></a>, which is an <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a> object representing the <a class="reference internal" href="../glossary.html#term-edge"><span class="xref std std-term">edge</span></a> that is <a class="reference internal" href="../glossary.html#term-incident-edge"><span class="xref std std-term">incident to or subtends</span></a> the <a class="reference internal" href="../glossary.html#term-node"><span class="xref std std-term">node</span></a> represented by that <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object.
Each <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a>, in turn, has an attribute, <code class="xref py py-attr docutils literal notranslate"><span class="pre">head_node</span></code>, which is the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object representing the <a class="reference internal" href="../glossary.html#term-node"><span class="xref std std-term">node</span></a> that the edge subtends.</p>
<p>The <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>, <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>, and <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a> classes all have “<code class="docutils literal notranslate"><span class="pre">annotations</span></code>” as an attribute, which is a <a class="reference internal" href="../library/basemodel.html#dendropy.datamodel.basemodel.AnnotationSet" title="dendropy.datamodel.basemodel.AnnotationSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnnotationSet</span></code></a> object, i.e. a collection of <a class="reference internal" href="../library/basemodel.html#dendropy.datamodel.basemodel.Annotation" title="dendropy.datamodel.basemodel.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a> instances tracking metadata.
More information on working with metadata can be found in the “<a class="reference internal" href="working_with_metadata_annotations.html"><span class="doc">Working with Metadata Annotations</span></a>” section.</p>
</section>
<section id="reading-and-writing-tree-instances">
<h2>Reading and Writing <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> Instances<a class="headerlink" href="#reading-and-writing-tree-instances" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> class supports the “<a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.get" title="dendropy.datamodel.treemodel.Tree.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get</span></code></a>” factory class method for simultaneously instantiating and populating a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> instance, taking a data source as the first argument and a <a class="reference internal" href="../schemas/index.html#specifying-the-data-source-format"><span class="std std-ref">schema specification string</span></a> (”<code class="docutils literal notranslate"><span class="pre">nexus</span></code>”, “<code class="docutils literal notranslate"><span class="pre">newick</span></code>”, “<code class="docutils literal notranslate"><span class="pre">nexml</span></code>”, “<code class="docutils literal notranslate"><span class="pre">fasta</span></code>”, or “<code class="docutils literal notranslate"><span class="pre">phylip</span></code>”, etc.) as the second:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mcmc.nex&#39;</span><span class="p">,</span>
    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object can be written to an external resource using the “<a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.write" title="dendropy.datamodel.treemodel.Tree.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write</span></code></a>” method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;trees1.nex&quot;</span><span class="p">,</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">,</span>
    <span class="n">tree_offset</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;trees1.newick&quot;</span><span class="p">,</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>It can also be represented as a string using the “<a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.as_string" title="dendropy.datamodel.treemodel.Tree.as_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_string</span></code></a>” method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;trees1.nex&quot;</span><span class="p">,</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">,)</span>
</pre></div>
</div>
<p>More information on reading operations is available in the <a class="reference internal" href="reading_and_writing.html"><span class="doc">Reading and Writing Phylogenetic Data</span></a> section.</p>
</section>
<section id="cloning-copying-a-tree">
<h2>Cloning/Copying a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a><a class="headerlink" href="#cloning-copying-a-tree" title="Link to this heading">¶</a></h2>
<p>You can make a “taxon namespace-scoped” copy of a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> instance, i.e., where all <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> and associated <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a> instances of a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> are cloned, but references to <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.Taxon" title="dendropy.datamodel.taxonmodel.Taxon"><code class="xref py py-class docutils literal notranslate"><span class="pre">Taxon</span></code></a> objects are preserved, you can call <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.clone" title="dendropy.datamodel.treemodel.Tree.clone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dendropy.datamodel.treemodel.Tree.clone</span></code></a> with a “<code class="docutils literal notranslate"><span class="pre">depth</span></code>” argument value of 1 or by copy construction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>

<span class="c1"># original list</span>
<span class="n">s1</span> <span class="o">=</span> <span class="s2">&quot;(A,(B,C));&quot;</span>
<span class="n">tree1</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="c1"># taxon namespace-scoped deep copy by calling Tree.clone(1)</span>
<span class="c1"># I.e. Everything cloned, but with Taxon and TaxonNamespace references shared</span>
<span class="n">tree2</span> <span class="o">=</span> <span class="n">tree1</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># taxon namespace-scoped deep copy by copy-construction</span>
<span class="c1"># I.e. Everything cloned, but with Taxon and TaxonNamespace references shared</span>
<span class="n">tree3</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="p">(</span><span class="n">tree1</span><span class="p">)</span>

<span class="c1"># *different* tree instances, with different nodes and edges</span>
<span class="k">for</span> <span class="n">nd1</span><span class="p">,</span> <span class="n">nd2</span><span class="p">,</span> <span class="n">nd3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tree1</span><span class="p">,</span> <span class="n">tree2</span><span class="p">,</span> <span class="n">tree3</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">nd1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nd2</span>
    <span class="k">assert</span> <span class="n">nd1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nd3</span>
    <span class="k">assert</span> <span class="n">nd2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nd3</span>

<span class="c1"># Note: TaxonNamespace is still shared</span>
<span class="c1"># I.e. Everything cloned, but with Taxon and TaxonNamespace references shared</span>
<span class="k">assert</span> <span class="n">tree2</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="n">tree1</span><span class="o">.</span><span class="n">taxon_namespace</span>
<span class="k">assert</span> <span class="n">tree3</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="n">tree1</span><span class="o">.</span><span class="n">taxon_namespace</span>
</pre></div>
</div>
<p>For a true and complete deep-copy, where even the <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.Taxon" title="dendropy.datamodel.taxonmodel.Taxon"><code class="xref py py-class docutils literal notranslate"><span class="pre">Taxon</span></code></a> and <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.TaxonNamespace" title="dendropy.datamodel.taxonmodel.TaxonNamespace"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaxonNamespace</span></code></a> references are copied, call <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy.deepcopy</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="c1"># original list</span>
<span class="n">s1</span> <span class="o">=</span> <span class="s2">&quot;(A,(B,C));&quot;</span>
<span class="n">tree1</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="c1"># Full deep copy by calling copy.deepcopy()</span>
<span class="c1"># I.e. Everything cloned including Taxon and TaxonNamespace instances</span>
<span class="n">tree2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tree1</span><span class="p">)</span>

<span class="c1"># *different* tree instances</span>
<span class="k">for</span> <span class="n">nd1</span><span class="p">,</span> <span class="n">nd2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tree1</span><span class="p">,</span> <span class="n">tree2</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">nd1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nd2</span>

<span class="c1"># Note: TaxonNamespace is also different</span>
<span class="k">assert</span> <span class="n">tree2</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">tree1</span><span class="o">.</span><span class="n">taxon_namespace</span>
<span class="k">for</span> <span class="n">tx1</span> <span class="ow">in</span> <span class="n">tree1</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">tx1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tree2</span><span class="o">.</span><span class="n">taxon_namespace</span>
<span class="k">for</span> <span class="n">tx2</span> <span class="ow">in</span> <span class="n">tree2</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">tx2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tree1</span><span class="o">.</span><span class="n">taxon_namespace</span>
</pre></div>
</div>
<p>Alternatively, many times you want a “light” or “thin” copy, where just the tree structure (node and edge relationships) and basic information are retained (e.g., edge lengths, taxon associations, and node and edge labels), but not, e.g. the rich annotations. Then the <code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree</span></code> method is what you are looking for:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="kn">from</span> <span class="nn">dendropy.calculate</span> <span class="kn">import</span> <span class="n">treecompare</span>

<span class="n">tree0</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">nd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tree0</span><span class="p">):</span>
    <span class="n">nd</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;hello, world</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;world, hello</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="n">nd</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
    <span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;taste&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sweet&quot;</span>
<span class="n">tree1</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">tree0</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="n">tree1</span><span class="o">.</span><span class="n">taxon_namespace</span>
<span class="k">assert</span> <span class="n">treecompare</span><span class="o">.</span><span class="n">weighted_robinson_foulds_distance</span><span class="p">(</span>
        <span class="n">tree0</span><span class="p">,</span> <span class="n">tree1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span>

<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">tree1</span><span class="p">:</span>
    <span class="n">original_node</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">extraction_source</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> on extracted tree corresponds to </span><span class="si">{}</span><span class="s2"> on original tree&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">nd</span><span class="p">,</span> <span class="n">original_node</span><span class="p">))</span>
    <span class="c1">## basic attributes copied</span>
    <span class="k">assert</span> <span class="n">nd</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">original_node</span><span class="o">.</span><span class="n">label</span>
    <span class="k">assert</span> <span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">original_node</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">label</span>
    <span class="k">assert</span> <span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="n">original_node</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span>
    <span class="c1">## but not annotations</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">annotations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_node</span><span class="o">.</span><span class="n">annotations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">annotations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_node</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">annotations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>


</pre></div>
</div>
</section>
<section id="tree-traversal">
<h2>Tree Traversal<a class="headerlink" href="#tree-traversal" title="Link to this heading">¶</a></h2>
<section id="iterating-over-nodes">
<h3>Iterating Over Nodes<a class="headerlink" href="#iterating-over-nodes" title="Link to this heading">¶</a></h3>
<p>The following example shows how you might evolve a continuous character on a tree by recursively visting each node, and setting the value of the character to one drawn from a normal distribution centered on the value of the character of the node’s ancestor and standard deviation given by the length of the edge subtending the node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#! /usr/bin/env python</span>
<span class="linenos"> 2</span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">random</span>
<span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="k">def</span> <span class="nf">process_node</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="linenos"> 8</span>    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">parent_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 9</span>        <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">start</span>
<span class="linenos">10</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">11</span>        <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">parent_node</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
<span class="linenos">12</span>    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">child_nodes</span><span class="p">():</span>
<span class="linenos">13</span>        <span class="n">process_node</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="linenos">14</span>    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">taxon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">15</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">taxon</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="n">mle</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos">18</span>    <span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mle.nex&#39;</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">)</span>
<span class="linenos">20</span><span class="n">process_node</span><span class="p">(</span><span class="n">mle</span><span class="o">.</span><span class="n">seed_node</span><span class="p">)</span>
<span class="linenos">21</span>
</pre></div>
</div>
<p>While the previous example works, it is probably clearer and more efficient to use one of the pre-defined node iterator methods:</p>
<blockquote>
<div><dl class="simple">
<dt><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.preorder_node_iter" title="dendropy.datamodel.treemodel.Tree.preorder_node_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preorder_node_iter</span></code></a></dt><dd><p>Iterates over nodes in a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object in a <a class="reference external" href="http://en.wikipedia.org/wiki/Depth-first_traversal">depth-first</a> search pattern, i.e., “visiting” a node before visiting the children of the node. This is the same traversal order as the previous example. This traversal order is useful if you require ancestral nodes to be processed before descendent nodes, as, for example, when evolving sequences over a tree.</p>
</dd>
<dt><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.postorder_node_iter" title="dendropy.datamodel.treemodel.Tree.postorder_node_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">postorder_node_iter</span></code></a></dt><dd><p>Iterates over nodes in a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object in a <a class="reference external" href="http://en.wikipedia.org/wiki/Tree_traversal">postorder</a> search pattern, i.e., visiting the children of the node before visiting the node itself. This traversal order is useful if you require descendent nodes to be processed before ancestor nodes, as, for example, when calculating ages of nodes.</p>
</dd>
<dt><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.level_order_node_iter" title="dendropy.datamodel.treemodel.Tree.level_order_node_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">level_order_node_iter</span></code></a></dt><dd><p>Iterates over nodes in a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object in a  <a class="reference external" href="http://en.wikipedia.org/wiki/Breadth-first_traversal">breadth-first</a>  search pattern, i.e., every node at a particular level is visited before proceeding to the next level.</p>
</dd>
<dt><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.leaf_node_iter" title="dendropy.datamodel.treemodel.Tree.leaf_node_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">leaf_node_iter</span></code></a></dt><dd><p>Iterates over the leaf or tip nodes of a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object.</p>
</dd>
</dl>
</div></blockquote>
<p>The previous example would thus be better implemented as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="k">def</span> <span class="nf">evolve_char</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">preorder_node_iter</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">parent_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">parent_node</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree</span>

<span class="n">mle</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mle.nex&#39;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">)</span>
<span class="n">evolve_char</span><span class="p">(</span><span class="n">mle</span><span class="p">)</span>
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">mle</span><span class="o">.</span><span class="n">leaf_iter</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">taxon</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
<p>The nodes returned by each of these iterators can be filtered if a filter function is passed as a second argument to the iterator.
This filter function should take a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object as an argument, and return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the node is to be returned or <code class="docutils literal notranslate"><span class="pre">False</span></code> if it is not. For example, the following iterates over all nodes that have more than two children:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#! /usr/bin/env python</span>
<span class="linenos"> 2</span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="linenos"> 8</span>    <span class="s2">&quot;This example is known to be broken! &quot;</span>
<span class="linenos"> 9</span>    <span class="s2">&quot;It will be fixed or removed in the future. &quot;</span>
<span class="linenos">10</span>    <span class="s2">&quot;See https://github.com/jeetsukumaran/DendroPy/issues/160 for details. &quot;</span>
<span class="linenos">11</span>    <span class="s2">&quot;Patch contributions are welcome.&quot;</span><span class="p">,</span>
<span class="linenos">12</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">mle</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos">15</span>    <span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mle.nex&#39;</span><span class="p">,</span>
<span class="linenos">16</span>    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">)</span>
<span class="linenos">17</span><span class="n">multifurcating</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">child_nodes</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">False</span>
<span class="linenos">18</span><span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">mle</span><span class="o">.</span><span class="n">postorder_node_iter</span><span class="p">(</span><span class="n">multifurcating</span><span class="p">):</span>
<span class="linenos">19</span>    <span class="nb">print</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">description</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="iterating-over-edges">
<h3>Iterating Over Edges<a class="headerlink" href="#iterating-over-edges" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a> objects associated with each <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> can be accessed through the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.edge" title="dendropy.datamodel.treemodel.Node.edge"><code class="xref py py-attr docutils literal notranslate"><span class="pre">edge</span></code></a> attribute of the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object.
So it is possible to iterate over every edge on a tree by iterating over the nodes and referencing the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.edge" title="dendropy.datamodel.treemodel.Node.edge"><code class="xref py py-attr docutils literal notranslate"><span class="pre">edge</span></code></a> attribute of the node when processing the node.
But it is clearer and probably more convenient to use one of the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a> iterators:</p>
<blockquote>
<div><dl class="simple">
<dt><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.preorder_edge_iter" title="dendropy.datamodel.treemodel.Tree.preorder_edge_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preorder_edge_iter</span></code></a></dt><dd><p>Iterates over edges in a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object in a <a class="reference external" href="http://en.wikipedia.org/wiki/Depth-first_traversal">depth-first</a> search pattern, i.e., “visiting” an edge before visiting the edges descending from that edge. This is the same traversal order as the previous example. This traversal order is useful if you require ancestral edges to be processed before descendent edges, as, for example, when calculating the sum of edge lengths from the root.</p>
</dd>
<dt><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.postorder_edge_iter" title="dendropy.datamodel.treemodel.Tree.postorder_edge_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">postorder_edge_iter</span></code></a></dt><dd><p>Iterates over edges in a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object in a <a class="reference external" href="http://en.wikipedia.org/wiki/Tree_traversal">postorder</a> search pattern, i.e., visiting the descendents of the edge before visiting the edge itself. This traversal order is useful if you require descendent edges to be processed before ancestral edges, as, for example, when calculating the sum of edge lengths from the tip</p>
</dd>
<dt><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.level_order_edge_iter" title="dendropy.datamodel.treemodel.Tree.level_order_edge_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">level_order_edge_iter</span></code></a></dt><dd><p>Iterates over edges in a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object in a  <a class="reference external" href="http://en.wikipedia.org/wiki/Breadth-first_traversal">breadth-first</a>  search pattern, i.e., every edge at a particular level is visited before proceeding to the next level.</p>
</dd>
</dl>
</div></blockquote>
<p>The following example sets the edge lengths of a tree to the proportions of the total tree length that they represent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#! /usr/bin/env python</span>
<span class="linenos"> 2</span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">mle</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mle.nex&#39;</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="n">mle_len</span> <span class="o">=</span> <span class="n">mle</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
<span class="linenos"> 8</span><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">mle</span><span class="o">.</span><span class="n">postorder_edge_iter</span><span class="p">():</span>
<span class="linenos"> 9</span>    <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="n">edge</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">11</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">12</span>        <span class="n">edge</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span><span class="p">)</span><span class="o">/</span><span class="n">mle_len</span>
<span class="linenos">13</span><span class="nb">print</span><span class="p">(</span><span class="n">mle</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>While this one removes the edge lengths entirely:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#! /usr/bin/env python</span>
<span class="linenos"> 2</span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">mle</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos"> 7</span>    <span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mle.nex&#39;</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="n">mle_len</span> <span class="o">=</span> <span class="n">mle</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
<span class="linenos">10</span><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">mle</span><span class="o">.</span><span class="n">postorder_edge_iter</span><span class="p">():</span>
<span class="linenos">11</span>    <span class="n">edge</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="kc">None</span>
<span class="linenos">12</span><span class="nb">print</span><span class="p">(</span><span class="n">mle</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Like the node iterators, the edge iterators also optionally take a filter function as a second argument, except here the filter function should take an <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a> object as an argument.
The following example shows how you might iterate over all edges with lengths less than some value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#! /usr/bin/env python</span>
<span class="linenos"> 2</span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="linenos"> 8</span>    <span class="s2">&quot;This example is known to be broken! &quot;</span>
<span class="linenos"> 9</span>    <span class="s2">&quot;It will be fixed or removed in the future. &quot;</span>
<span class="linenos">10</span>    <span class="s2">&quot;See https://github.com/jeetsukumaran/DendroPy/issues/160 for details. &quot;</span>
<span class="linenos">11</span>    <span class="s2">&quot;Patch contributions are welcome.&quot;</span><span class="p">,</span>
<span class="linenos">12</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">mle</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos">15</span>    <span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mle.nex&#39;</span><span class="p">,</span>
<span class="linenos">16</span>    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">)</span>
<span class="linenos">17</span><span class="n">short</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">edge</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;</span> <span class="mf">0.01</span> <span class="k">else</span> <span class="kc">False</span>
<span class="linenos">18</span><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">mle</span><span class="o">.</span><span class="n">postorder_edge_iter</span><span class="p">(</span><span class="n">short</span><span class="p">):</span>
<span class="linenos">19</span>    <span class="nb">print</span><span class="p">(</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="finding-nodes-on-trees">
<h2>Finding Nodes on Trees<a class="headerlink" href="#finding-nodes-on-trees" title="Link to this heading">¶</a></h2>
<section id="nodes-with-particular-taxa">
<h3>Nodes with Particular Taxa<a class="headerlink" href="#nodes-with-particular-taxa" title="Link to this heading">¶</a></h3>
<p>To retrieve a node associated with a particular taxon, we can use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">find_taxon_node</span></code> method, which takes a filter function as an argument.
The filter function should take a <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.Taxon" title="dendropy.datamodel.taxonmodel.Taxon"><code class="xref py py-class docutils literal notranslate"><span class="pre">Taxon</span></code></a> object as an argument and return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the taxon is to be returned.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>
<span class="nb">filter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">taxon</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">taxon</span><span class="o">.</span><span class="n">label</span><span class="o">==</span><span class="s1">&#39;Antaresia maculosa&#39;</span> <span class="k">else</span> <span class="kc">False</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">find_node_with_taxon</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">description</span><span class="p">())</span>
</pre></div>
</div>
<p>Because we might find it easier to refer to <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.Taxon" title="dendropy.datamodel.taxonmodel.Taxon"><code class="xref py py-class docutils literal notranslate"><span class="pre">Taxon</span></code></a> objects by their labels, a convenience method that wraps the retrieval of nodes associated with <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.Taxon" title="dendropy.datamodel.taxonmodel.Taxon"><code class="xref py py-class docutils literal notranslate"><span class="pre">Taxon</span></code></a> objects of particular label is provided:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">find_node_with_taxon_label</span><span class="p">(</span><span class="s1">&#39;Antaresia maculosa&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">description</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="most-recent-common-ancestors">
<h3>Most Recent Common Ancestors<a class="headerlink" href="#most-recent-common-ancestors" title="Link to this heading">¶</a></h3>
<p>The MRCA (most recent common ancestor) of taxa or nodes can be retrieved by the instance method <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.mrca" title="dendropy.datamodel.treemodel.Tree.mrca"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mrca</span></code></a>.
This method takes a list of <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.Taxon" title="dendropy.datamodel.taxonmodel.Taxon"><code class="xref py py-class docutils literal notranslate"><span class="pre">Taxon</span></code></a> objects given by the <code class="docutils literal notranslate"><span class="pre">taxa</span></code> keyword argument, or a list of taxon labels given by the <code class="docutils literal notranslate"><span class="pre">taxon_labels</span></code> keyword argument, and returns a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object that corresponds to the MRCA of the specified taxa.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>
<span class="n">taxon_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Python sebae&#39;</span><span class="p">,</span>
              <span class="s1">&#39;Python regius&#39;</span><span class="p">,</span>
              <span class="s1">&#39;Python curtus&#39;</span><span class="p">,</span>
              <span class="s1">&#39;Python molurus&#39;</span><span class="p">]</span>
<span class="n">mrca</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">mrca</span><span class="p">(</span><span class="n">taxon_labels</span><span class="o">=</span><span class="n">taxon_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mrca</span><span class="o">.</span><span class="n">description</span><span class="p">())</span>
</pre></div>
</div>
<p>Note that this method is inefficient when you need to resolve MRCA’s for multiple sets or pairs of taxa.
In this context, the <code class="xref py py-class docutils literal notranslate"><span class="pre">PhylogeneticDistanceMatrix</span></code> offers a more efficient approach, and should be preferred for applications such as calculating the patristic distances between all pairs of taxa. An instance of this class will be returned when you call <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.phylogenetic_distance_matrix" title="dendropy.datamodel.treemodel.Tree.phylogenetic_distance_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">phylogenetic_distance_matrix</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>
<span class="n">pdm</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">phylogenetic_distance_matrix</span><span class="p">()</span>
<span class="k">for</span> <span class="n">idx1</span><span class="p">,</span> <span class="n">taxon1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">taxon2</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">taxon_namespace</span><span class="p">:</span>
        <span class="n">mrca</span> <span class="o">=</span> <span class="n">pdm</span><span class="o">.</span><span class="n">mrca</span><span class="p">(</span><span class="n">taxon1</span><span class="p">,</span> <span class="n">taxon2</span><span class="p">)</span>
        <span class="n">weighted_patristic_distance</span> <span class="o">=</span> <span class="n">pdm</span><span class="o">.</span><span class="n">patristic_distance</span><span class="p">(</span><span class="n">taxon1</span><span class="p">,</span> <span class="n">taxon2</span><span class="p">)</span>
        <span class="n">unweighted_patristic_distance</span> <span class="o">=</span> <span class="n">pdm</span><span class="o">.</span><span class="n">path_edge_count</span><span class="p">(</span><span class="n">taxon1</span><span class="p">,</span> <span class="n">taxon2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39; vs &#39;</span><span class="si">{}</span><span class="s2">&#39;: </span><span class="si">{}</span><span class="s2"> (distance (weighted-edges, unweighted-edges) = </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">taxon1</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">taxon2</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">mrca</span><span class="o">.</span><span class="n">bipartition</span><span class="o">.</span><span class="n">split_as_bitstring</span><span class="p">(),</span>
            <span class="n">weighted_patristic_distance</span><span class="p">,</span>
            <span class="n">unweighted_patristic_distance</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that the <a class="reference internal" href="../library/phylogeneticdistance.html#dendropy.calculate.phylogeneticdistance.PhylogeneticDistanceMatrix" title="dendropy.calculate.phylogeneticdistance.PhylogeneticDistanceMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhylogeneticDistanceMatrix</span></code></a> object does not automatically update if the original <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> changes: it is essentially a snapshot of <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> at the point in which it is instantiated.
If the original <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> changes, you should create a new instance of the corresponding <a class="reference internal" href="../library/phylogeneticdistance.html#dendropy.calculate.phylogeneticdistance.PhylogeneticDistanceMatrix" title="dendropy.calculate.phylogeneticdistance.PhylogeneticDistanceMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhylogeneticDistanceMatrix</span></code></a> object.</p>
</section>
</section>
<section id="viewing-and-displaying-trees">
<h2>Viewing and Displaying Trees<a class="headerlink" href="#viewing-and-displaying-trees" title="Link to this heading">¶</a></h2>
<p>Sometimes it is useful to get a visual representation of a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>.</p>
<p>For quick inspection, the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.print_plot" title="dendropy.datamodel.treemodel.Tree.print_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_plot</span></code></a> will write an ASCII text plot to the standard output stream:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get_from_string</span><span class="p">(</span><span class="s2">&quot;(A,(B,(C,D)));&quot;</span><span class="p">,</span> <span class="s2">&quot;newick&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">print_plot</span><span class="p">()</span>
<span class="go">/----------------------------------------------- A</span>
<span class="go">+</span>
<span class="go">|                /------------------------------ B</span>
<span class="go">\----------------+</span>
<span class="go">                 |          /------------------- C</span>
<span class="go">                 \----------+</span>
<span class="go">                            \------------------- D</span>
</pre></div>
</div>
<p>If you need to store this representation as a string instead, you can use <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.as_ascii_plot" title="dendropy.datamodel.treemodel.Tree.as_ascii_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_ascii_plot</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">/----------------------------------------------- A</span>
<span class="go">+</span>
<span class="go">|                /------------------------------ B</span>
<span class="go">\----------------+</span>
<span class="go">                 |          /------------------- C</span>
<span class="go">                 \----------+</span>
<span class="go">                            \------------------- D</span>
</pre></div>
</div>
<p>You can also, as mentioned above, using the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.as_string" title="dendropy.datamodel.treemodel.Tree.as_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_string</span></code></a> method to represent a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> as string in any format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get_from_string</span><span class="p">(</span><span class="s2">&quot;(A,(B,(C,D)));&quot;</span><span class="p">,</span> <span class="s2">&quot;newick&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="building-a-tree-programmatically">
<h2>Building a Tree Programmatically<a class="headerlink" href="#building-a-tree-programmatically" title="Link to this heading">¶</a></h2>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">taxon_namespace</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">TaxonNamespace</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,])</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="p">(</span><span class="n">taxon_namespace</span><span class="o">=</span><span class="n">taxon_namespace</span><span class="p">)</span>


<span class="c1"># Create and add a new child node to the seed node,</span>
<span class="c1"># assigning it an edge length:</span>
<span class="c1">#</span>
<span class="c1">#     (seed)</span>
<span class="c1">#      /</span>
<span class="c1">#     /</span>
<span class="c1">#    ch1</span>
<span class="c1">#</span>
<span class="n">ch1</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">seed_node</span><span class="o">.</span><span class="n">new_child</span><span class="p">()</span>
<span class="n">ch1</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Can also assign edge length on construction:</span>
<span class="c1">#</span>
<span class="c1">#     (seed)</span>
<span class="c1">#      / \</span>
<span class="c1">#     /   \</span>
<span class="c1">#   ch1   ch2</span>
<span class="c1">#</span>
<span class="n">ch2</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">seed_node</span><span class="o">.</span><span class="n">new_child</span><span class="p">(</span><span class="n">edge_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Can also add an existing node as child</span>
<span class="c1">#</span>
<span class="c1">#       (seed)</span>
<span class="c1">#       /   \</span>
<span class="c1">#      /     \</span>
<span class="c1">#    ch1     ch2</span>
<span class="c1">#   /  \     /  \</span>
<span class="c1">#  ch3 ch4  ch5 ch6</span>
<span class="n">ch3</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">edge_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ch4</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">edge_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ch1</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">ch3</span><span class="p">)</span>
<span class="n">ch1</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">ch4</span><span class="p">)</span>
<span class="n">ch5</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">edge_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ch6</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">edge_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Note: this clears/deletes existing child nodes before adding the new ones;</span>
<span class="n">ch2</span><span class="o">.</span><span class="n">set_child_nodes</span><span class="p">([</span><span class="n">ch5</span><span class="p">,</span> <span class="n">ch6</span><span class="p">])</span>

<span class="c1"># Assign taxa</span>
<span class="n">ch3</span><span class="o">.</span><span class="n">taxon</span> <span class="o">=</span> <span class="n">taxon_namespace</span><span class="o">.</span><span class="n">get_taxon</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">ch4</span><span class="o">.</span><span class="n">taxon</span> <span class="o">=</span> <span class="n">taxon_namespace</span><span class="o">.</span><span class="n">get_taxon</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="n">ch5</span><span class="o">.</span><span class="n">taxon</span> <span class="o">=</span> <span class="n">taxon_namespace</span><span class="o">.</span><span class="n">get_taxon</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
<span class="n">ch6</span><span class="o">.</span><span class="n">taxon</span> <span class="o">=</span> <span class="n">taxon_namespace</span><span class="o">.</span><span class="n">get_taxon</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
</pre></div>
</div>
<p>produces the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">A</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">B</span><span class="p">:</span><span class="mi">2</span><span class="p">):</span><span class="mi">1</span><span class="p">,(</span><span class="n">C</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">D</span><span class="p">:</span><span class="mi">2</span><span class="p">):</span><span class="mi">1</span><span class="p">);</span>

                                   <span class="o">/----------------------------------</span> <span class="n">A</span>
<span class="o">/----------------------------------+</span>
<span class="o">|</span>                                  \<span class="o">----------------------------------</span> <span class="n">B</span>
<span class="o">+</span>
<span class="o">|</span>                                  <span class="o">/----------------------------------</span> <span class="n">C</span>
\<span class="o">----------------------------------+</span>
                                   \<span class="o">----------------------------------</span> <span class="n">D</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div style="text-align: center; padding-top: 20px; padding-bottom: 5px; width: 100%;">
    <a href="../index.html"><img src="../_static/dendropy_logo.png" /></a>
</div><div style="clear:both; width: 100%; height:1px;"></div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div style="clear:both; width: 100%; height:1px;"></div>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Trees</a><ul>
<li><a class="reference internal" href="#the-tree-class">The <code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code> Class</a></li>
<li><a class="reference internal" href="#reading-and-writing-tree-instances">Reading and Writing <code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code> Instances</a></li>
<li><a class="reference internal" href="#cloning-copying-a-tree">Cloning/Copying a <code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a></li>
<li><a class="reference internal" href="#tree-traversal">Tree Traversal</a><ul>
<li><a class="reference internal" href="#iterating-over-nodes">Iterating Over Nodes</a></li>
<li><a class="reference internal" href="#iterating-over-edges">Iterating Over Edges</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finding-nodes-on-trees">Finding Nodes on Trees</a><ul>
<li><a class="reference internal" href="#nodes-with-particular-taxa">Nodes with Particular Taxa</a></li>
<li><a class="reference internal" href="#most-recent-common-ancestors">Most Recent Common Ancestors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#viewing-and-displaying-trees">Viewing and Displaying Trees</a></li>
<li><a class="reference internal" href="#building-a-tree-programmatically">Building a Tree Programmatically</a></li>
</ul>
</li>
</ul>

  </div><div style="clear:both; width: 100%; height:1px;"></div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="taxa_partitions.html"
                          title="previous chapter">Partitions of Taxon Sets</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="treecollections.html"
                          title="next chapter">Collections of Trees</a></p>
  </div><div style="clear:both; width: 100%; height:1px;"></div>
    <!-- Documentation -->
    <div style="border-top: double 1px white; padding-top: 10px;">
        <h3>Documentation</h3>
        <ul>
            <li><a href="downloading.html">Downloading and Installing DendroPy</a></li>
            <li><a href="index.html">The DendroPy Primer</a></li>
            <li><a href="../library/index.html">Library API Reference</a></li>
            <li>
                <a href="../schemas/index.html">Schemas</a>
                <ul>
                    <li><a href="../schemas/fasta.html">FASTA</a></li>
                    <li><a href="../schemas/newick.html">Newick</a></li>
                    <li><a href="../schemas/nexml.html">NeXML</a></li>
                    <li><a href="../schemas/nexus.html">Nexus</a></li>
                    <li><a href="../schemas/phylip.html">PHYLIP</a></li>
                </ul>
            </li>
            <li>
                <a href="../programs/index.html">Programs</a>
                <ul>
                    <li><a href="../programs/sumtrees.html">SumTrees</a></li>
                </ul>
            </li>
            <li><a href="../glossary.html">Glossary and Terminological Reference</a></li>
            <li><a href="../developer.html">Developer Guide</a></li>
            <li><a href="../planning.html">Ongoing Development</a></li>
            <li><a href="../changes.html">Change History</a></li>
        </ul>
    </div>

    <!-- Downloads -->
    <div style="border-top: double 1px white; padding-top: 10px;">
        <h3>Obtaining</h3>
        <ul>
            <li><a target="_blank" href="http://pypi.python.org/pypi/DendroPy">Install from the Python Package Index</a></li>
            <li><a target="_blank" href="http://pypi.python.org/packages/source/D/DendroPy/DendroPy-5.0.2.tar.gz">Download the Source Code Archive</a></li>
            <li><a target="_blank" href="http://github.com/jeetsukumaran/DendroPy">Clone the Source Code Repository</a></li>
        </ul>
    </div>

    <!-- Discussions -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative;">
        <h3><span style="text-align: left">Discussion</span><span style="position: absolute; right: 0; top: 10px "><img src="../_static/google-groups-logo1.png" height="20px" alt="Google Groups" /></span></h3>
        <div style="margin-top: 15px;">
            <p style="font-size: 90%; margin-top: 3px; clear: both;">Join the <a href="http://groups.google.com/group/dendropy-users?hl=en">&quot; DendroPy Users&quot; </a>group to follow and participate in discussion, troubleshooting, help, information, suggestions, etc. on the usage and development of the DendroPy phylogenetic computing library.</p>
            <form action="http://groups.google.com/group/dendropy-users/boxsubscribe">
                <input type=text name=email>
                <input type=submit name="sub" value="Subscribe">
            </form>
            <p style="font-size: 90%; clear: both; padding-top: 5px; padding-bottom: 10px;">Enter your e-mail address in the box above and click the &quot;subscribe&quot; button to subscribe to the <a href="http://groups.google.com/group/dendropy-users?hl=en">&quot;dendropy-users&quot;</a> group, or click <a href="http://groups.google.com/group/dendropy-users?hl=en">here</a> to visit this group page directly.</p>
        </div>
    </div>

    <!-- Announcements -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative;">
        <h3><span style="text-align: left">Announcements</span><span style="position: absolute; right: 0; top: 10px "><img src="../_static/google-groups-logo1.png" height="20px" alt="Google Groups" /></span></h3>
        <div style="margin-top: 15px;">
            <p style="font-size: 90%; margin-top: 3px; clear: both;">Join the <a href="http://groups.google.com/group/dendropy-announce?hl=en">&quot; DendroPy Announcements&quot; </a>group to receive announcements of new releases, updates, changes and other news of interest to DendroPy users and developers.</p>
            <form action="http://groups.google.com/group/dendropy-announce/boxsubscribe">
                <input type=text name=email>
                <input type=submit name="sub" value="Subscribe">
            </form>
            <p style="font-size: 90%; clear: both; padding-top: 5px; padding-bottom: 10px;">Enter your e-mail address in the box above and click the &quot;subscribe&quot; button to subscribe to the <a href="http://groups.google.com/group/dendropy-announce?hl=en">&quot; dendropy-announce&quot; </a>group, or click <a href="http://groups.google.com/group/dendropy-announce?hl=en">here</a> to visit this group page directly.</p>
        </div>
    </div>

    <!-- Development -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative; padding-bottom: 15px; margin-bottom:5px;">
        <h3><span style="text-align: left"><a href="https://github.com/jeetsukumaran/DendroPy/">Development</a></span><a href="https://github.com/jeetsukumaran/DendroPy/"><span style="position: absolute; right: 0; top: 10px "><img src="../_static/Octocat.png" height="30px" alt="GitHub" /></span></a></h3>
        <div style="margin-top: 15px;">
            <!-- <a href="https://github.com/jeetsukumaran/DendroPy/issues">Issues</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/subscription">Watch</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/fork">Fork</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/stargazers">Star</a> &bull; <a href="https://github.com/jeetsukumaran/">Follow</a> -->
            <ul>
                <li>                <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/issues"><code>Issues</code></a></span> <span style="font-style: italic; font-size:80%;"> - Report bugs or request features</span></li>
                <li>     <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/subscription"><code>&nbsp;Watch</code></a></span> <span style="font-style: italic; font-size:80%;"> - Follow development activity</span></li>
                <li>        <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/fork"><code>&nbsp;&nbsp;Fork</code></a></span> <span style="font-style: italic; font-size:80%;"> - Contribute and collaborate</span></li>
                <li>  <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/stargazers"><code>&nbsp;&nbsp;Star</code></a></span> <span style="font-style: italic; font-size:80%;"> - Throw some glitter, add some glamour</span></li>
        </div>
    </div>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="treecollections.html" title="Collections of Trees"
             >next</a> |</li>
        <li class="right" >
          <a href="taxa_partitions.html" title="Partitions of Taxon Sets"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DendroPy 5.0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >The DendroPy Primer</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Trees</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2009-2024, Jeet Sukumaran and Mark T. Holder.
    </div>
  </body>
</html>