<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tree Manipulation and Restructuring &#8212; DendroPy 5.0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/rtd.css?v=cedc6a2f" />
    
    <script src="../_static/documentation_options.js?v=967d581c"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bipartitions" href="bipartitions.html" />
    <link rel="prev" title="Tree Statistics, Metrics, Summarizations, and Other Calculations" href="treestats.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bipartitions.html" title="Bipartitions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="treestats.html" title="Tree Statistics, Metrics, Summarizations, and Other Calculations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DendroPy 5.0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">The DendroPy Primer</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tree Manipulation and Restructuring</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="tree-manipulation-and-restructuring">
<h1>Tree Manipulation and Restructuring<a class="headerlink" href="#tree-manipulation-and-restructuring" title="Link to this heading">¶</a></h1>
<p>The <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> class provides both low-level and high-level methods for manipulating tree structure.</p>
<p>Low-level methods are associated with <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> objects, and allow to restructure the relationships between nodes at a fine level: <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.add_child" title="dendropy.datamodel.treemodel.Node.add_child"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_child</span></code></a>, <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.new_child" title="dendropy.datamodel.treemodel.Node.new_child"><code class="xref py py-meth docutils literal notranslate"><span class="pre">new_child</span></code></a>, <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node.remove_child" title="dendropy.datamodel.treemodel.Node.remove_child"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove_child</span></code></a>, etc.</p>
<p>In most cases, however, you will be using high-level methods to restructure <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> objects.</p>
<p>In all cases, if any part of the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object’s structural relations change, <em>and</em> you are interested in calculating any metrics or statistics on the tree or comparing the tree to another tree, you need to call <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.update_bipartitions" title="dendropy.datamodel.treemodel.Tree.update_bipartitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bipartitions</span></code></a> on the object to update the internal splits hash representation.
This is not done for you automatically because there is a computational cost associated with the operation, and the splits hashes are not always needed. Furthermore, even when needed, if there are a number of structural changes to be made to a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object before calculations/comparisions, it makes sense to postpone the splits rehashing until there all the tree manipulations are completed.
Most methods that affect the tree structure that require the splits hashes to updated take a <code class="docutils literal notranslate"><span class="pre">update_bipartitions</span></code> argument. By specifying <code class="docutils literal notranslate"><span class="pre">True</span></code> for this, the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object will recalculate the splits hashes after the changes have been made.</p>
<section id="rooting-derooting-and-rerooting">
<h2>Rooting, Derooting and Rerooting<a class="headerlink" href="#rooting-derooting-and-rerooting" title="Link to this heading">¶</a></h2>
<section id="the-rooting-of-tree-s-read-from-external-sources">
<h3>The Rooting of Tree(s) Read from External Sources<a class="headerlink" href="#the-rooting-of-tree-s-read-from-external-sources" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="../schemas/newick.html"><span class="doc">Newick</span></a> and <a class="reference internal" href="../schemas/nexus.html"><span class="doc">NEXUS</span></a> formats have a convention where the rooting of the tree is specified by a special comment token preceding the tree statement: “<code class="docutils literal notranslate"><span class="pre">[&amp;R]</span></code>” to indicate a rooted tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">),(</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">));</span>
</pre></div>
</div>
<p>and : “<code class="docutils literal notranslate"><span class="pre">[&amp;U]</span></code>” to indicate an unrooted tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&amp;</span><span class="n">U</span><span class="p">]</span> <span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">),(</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">));</span>
</pre></div>
</div>
<p>These rooting comment tokens are respected when tree data is read. If no such comment token is given, then the tree is assumed to be <strong>unrooted</strong> by default.</p>
<p>You can control the behavior of trees read by using the “<code class="docutils literal notranslate"><span class="pre">rooting</span></code> keyword argument when using the “<code class="xref py py-meth docutils literal notranslate"><span class="pre">get</span></code>” or “<code class="xref py py-meth docutils literal notranslate"><span class="pre">read</span></code>” methods of the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> or <a class="reference internal" href="../library/treecollectionmodel.html#dendropy.datamodel.treecollectionmodel.TreeList" title="dendropy.datamodel.treecollectionmodel.TreeList"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeList</span></code></a> classes. This takes one of four string values which determines how the rooting states of the tree(s) will be set:</p>
<blockquote>
<div><dl class="simple">
<dt>“default-unrooted” [default]</dt><dd><p>All trees are interpreted as unrooted unless a “[&amp;R]”
comment token explicitly specifies them as rooted.</p>
</dd>
<dt>“default-rooted”</dt><dd><p>All trees are interpreted as rooted unless a “[&amp;U]”
comment token explicitly specifies them as unrooted.</p>
</dd>
<dt>“force-unrooted”</dt><dd><p>All trees are unconditionally interpreted as unrooted.</p>
</dd>
<dt>“force-rooted”</dt><dd><p>All trees are unconditionally interpreted as rooted.</p>
</dd>
</dl>
</div></blockquote>
<p>The behavior of this can be be summarized by the following:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Keyword Argument</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&amp;U]</span></code> in Tree Statement</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&amp;R]</span></code> in Tree Statement</p></td>
<td><p>No Rooting Given in Tree Statement</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rooting=None</span></code> (or unspecified)</p></td>
<td><p>unrooted</p></td>
<td><p>rooted</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rooting=&quot;default-unrooted&quot;</span></code></p></td>
<td><p>unrooted</p></td>
<td><p>rooted</p></td>
<td><p>unrooted</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rooting=&quot;default-rooted&quot;</span></code></p></td>
<td><p>unrooted</p></td>
<td><p>rooted</p></td>
<td><p>rooted</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rooting=&quot;force-unrooted&quot;</span></code></p></td>
<td><p>unrooted</p></td>
<td><p>unrooted</p></td>
<td><p>unrooted</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rooting=&quot;force-rooted&quot;</span></code></p></td>
<td><p>rooted</p></td>
<td><p>rooted</p></td>
<td><p>rooted</p></td>
</tr>
</tbody>
</table>
<p>As an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>

<span class="c1"># force tree to be read as rooted</span>
<span class="n">mle_rooted</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mle.nex&#39;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">,</span>
        <span class="n">rooting</span><span class="o">=</span><span class="s1">&#39;force-rooted&#39;</span><span class="p">)</span>

<span class="c1"># force tree to be read as unrooted</span>
<span class="n">mle_rooted</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;pythonidae.mle.nex&#39;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;nexus&#39;</span><span class="p">,</span>
        <span class="n">rooting</span><span class="o">=</span><span class="s1">&#39;force-unrooted&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="setting-the-rooting-state">
<h3>Setting the Rooting State<a class="headerlink" href="#setting-the-rooting-state" title="Link to this heading">¶</a></h3>
<p>All <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> objects have a boolean property, <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_rooted</span></code> that DendroPy uses to track whether or not the tree should be treated as rooted. The property <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_unrooted</span></code> is also defined, and these two properties are synchronized. Thus setting <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_rooted</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> will result in <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_unrooted</span></code> being set to <code class="docutils literal notranslate"><span class="pre">False</span></code> and vice versa.</p>
<p>The state of a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object’s rootedness flag does not modify any internal structural relationship between nodes. It simply determines how its splits hashes are calculated, which in turn affects a broad range of comparison and metric operations. Thus you need to update the splits hashes after modifying the <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_rooted</span></code> property by calling the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.update_bipartitions" title="dendropy.datamodel.treemodel.Tree.update_bipartitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bipartitions</span></code></a> before carrying out any calculations on or with the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object. Note that calling <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.update_bipartitions" title="dendropy.datamodel.treemodel.Tree.update_bipartitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bipartitions</span></code></a> on an unrooted tree will force the basal split to be a trifurcation. So if the original tree was bifurcating, the end result will be a tree with a trifurcation at the root. This can be prevented by passing in the keyword argument <code class="docutils literal notranslate"><span class="pre">suppress_unifurcations=False</span></code> to <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.update_bipartitions" title="dendropy.datamodel.treemodel.Tree.update_bipartitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bipartitions</span></code></a>.</p>
<p>For example, the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] (A, (B, (C, (D, E))));&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get_from_string</span><span class="p">(</span>
        <span class="n">tree_str</span><span class="p">,</span>
        <span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>

<span class="n">tree</span><span class="o">.</span><span class="n">is_rooted</span> <span class="o">=</span> <span class="kc">False</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After `is_rooted=False`:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>

<span class="n">tree</span><span class="o">.</span><span class="n">update_bipartitions</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After `update_bipartitions()`:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>

<span class="n">tree2</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get_from_string</span><span class="p">(</span>
        <span class="n">tree_str</span><span class="p">,</span>
        <span class="s2">&quot;newick&quot;</span><span class="p">)</span>
<span class="n">tree2</span><span class="o">.</span><span class="n">is_rooted</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">tree2</span><span class="o">.</span><span class="n">update_bipartitions</span><span class="p">(</span><span class="n">suppress_unifurcations</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After `update_bipartitions(suppress_unifurcations=False)`:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree2</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
</pre></div>
</div>
<p>will result in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Original:
/---------------------------------------------------- A
+
|            /--------------------------------------- B
\------------+
             |            /-------------------------- C
             \------------+
                          |            /------------- D
                          \------------+
                                       \------------- E


After `is_rooted=False`:
/---------------------------------------------------- A
+
|            /--------------------------------------- B
\------------+
             |            /-------------------------- C
             \------------+
                          |            /------------- D
                          \------------+
                                       \------------- E


After `update_bipartitions()`:
/---------------------------------------------------- A
|
+---------------------------------------------------- B
|
|                /----------------------------------- C
\----------------+
                 |                 /----------------- D
                 \-----------------+
                                   \----------------- E


After `update_bipartitions(suppress_unifurcations=False)`:
/---------------------------------------------------- A
+
|            /--------------------------------------- B
\------------+
             |            /-------------------------- C
             \------------+
                          |            /------------- D
                          \------------+
                                       \------------- E
</pre></div>
</div>
</section>
<section id="derooting">
<h3>Derooting<a class="headerlink" href="#derooting" title="Link to this heading">¶</a></h3>
<p>To deroot a rooted <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>, you can also call the <code class="xref py py-meth docutils literal notranslate"><span class="pre">deroot</span></code> method, which collapses the root to a trifurcation if it is bifurcation <em>and</em> sets the <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_rooted</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>. The <code class="xref py py-meth docutils literal notranslate"><span class="pre">deroot</span></code> method has the same structural and semantic affect of <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_rooted</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> and then calling <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.update_bipartitions" title="dendropy.datamodel.treemodel.Tree.update_bipartitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bipartitions</span></code></a>. You would use the former if you are <em>not</em> going to be doing any tree comparisons or calculating tree metrics, and thus do not want to calculate the splits hashes.</p>
</section>
<section id="rerooting">
<h3>Rerooting<a class="headerlink" href="#rerooting" title="Link to this heading">¶</a></h3>
<p>To reroot a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> along an existing edge, you can use the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.reroot_at_edge" title="dendropy.datamodel.treemodel.Tree.reroot_at_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reroot_at_edge</span></code></a> method. This method takes an <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Edge" title="dendropy.datamodel.treemodel.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a> object as as its first argument. This rerooting is a structural change that will require the splits hashes to be updated before performing any tree comparisons or calculating tree metrics. If needed, you can do this yourself by calling <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.update_bipartitions" title="dendropy.datamodel.treemodel.Tree.update_bipartitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bipartitions</span></code></a> later, or you can pass in <code class="docutils literal notranslate"><span class="pre">True</span></code> as the second argument to the  <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.reroot_at_edge" title="dendropy.datamodel.treemodel.Tree.reroot_at_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reroot_at_edge</span></code></a> method call, which instructs DendroPy to automatically update the splits for you.</p>
<p>As an example, the following reroots the tree along an internal edge (note that we do not recalculate the splits hashes, as we are not carrying out any calculations or comparisons with the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] (A, (B, (C, (D, E))));&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">tree_str</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
<span class="n">mrca</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">mrca</span><span class="p">(</span><span class="n">taxon_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">])</span>
<span class="n">tree</span><span class="o">.</span><span class="n">reroot_at_edge</span><span class="p">(</span><span class="n">mrca</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> <span class="n">update_bipartitions</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>

</pre></div>
</div>
<p>and results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(</span><span class="n">A</span><span class="p">,(</span><span class="n">B</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">))));</span>

<span class="o">/----------------------------------------------------</span> <span class="n">A</span>
<span class="o">+</span>
<span class="o">|</span>            <span class="o">/---------------------------------------</span> <span class="n">B</span>
\<span class="o">------------+</span>
             <span class="o">|</span>            <span class="o">/--------------------------</span> <span class="n">C</span>
             \<span class="o">------------+</span>
                          <span class="o">|</span>            <span class="o">/-------------</span> <span class="n">D</span>
                          \<span class="o">------------+</span>
                                       \<span class="o">-------------</span> <span class="n">E</span>


<span class="n">After</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">),(</span><span class="n">C</span><span class="p">,(</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">)));</span>

                                   <span class="o">/-----------------</span> <span class="n">D</span>
<span class="o">/----------------------------------+</span>
<span class="o">|</span>                                  \<span class="o">-----------------</span> <span class="n">E</span>
<span class="o">+</span>
<span class="o">|</span>                <span class="o">/-----------------------------------</span> <span class="n">C</span>
\<span class="o">----------------+</span>
                 <span class="o">|</span>                 <span class="o">/-----------------</span> <span class="n">B</span>
                 \<span class="o">-----------------+</span>
                                   \<span class="o">-----------------</span> <span class="n">A</span>
</pre></div>
</div>
<p>Another example, this time rerooting along an edge subtending a tip instead of an internal edge:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] (A, (B, (C, (D, E))));&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">tree_str</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
<span class="n">node_D</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">find_node_with_taxon_label</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">reroot_at_edge</span><span class="p">(</span><span class="n">node_D</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> <span class="n">update_bipartitions</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>

</pre></div>
</div>
<p>which results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(</span><span class="n">A</span><span class="p">,(</span><span class="n">B</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">))));</span>

<span class="o">/----------------------------------------------------</span> <span class="n">A</span>
<span class="o">+</span>
<span class="o">|</span>            <span class="o">/---------------------------------------</span> <span class="n">B</span>
\<span class="o">------------+</span>
            <span class="o">|</span>             <span class="o">/--------------------------</span> <span class="n">C</span>
             \<span class="o">------------+</span>
                          <span class="o">|</span>            <span class="o">/-------------</span> <span class="n">D</span>
                          \<span class="o">------------+</span>
                                       \<span class="o">-------------</span> <span class="n">E</span>


<span class="n">After</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(</span><span class="n">D</span><span class="p">,(</span><span class="n">E</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">))));</span>

<span class="o">/----------------------------------------------------</span> <span class="n">D</span>
<span class="o">+</span>
<span class="o">|</span>            <span class="o">/---------------------------------------</span> <span class="n">E</span>
\<span class="o">------------+</span>
             <span class="o">|</span>            <span class="o">/--------------------------</span> <span class="n">C</span>
             \<span class="o">------------+</span>
                          <span class="o">|</span>            <span class="o">/-------------</span> <span class="n">B</span>
                          \<span class="o">------------+</span>
                                       \<span class="o">-------------</span> <span class="n">A</span>
</pre></div>
</div>
<p>To reroot a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> at a node instead, you can use the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.reroot_at_node" title="dendropy.datamodel.treemodel.Tree.reroot_at_node"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reroot_at_node</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] (A, (B, (C, (D, E))));&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">tree_str</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
<span class="n">mrca</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">mrca</span><span class="p">(</span><span class="n">taxon_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">])</span>
<span class="n">tree</span><span class="o">.</span><span class="n">reroot_at_node</span><span class="p">(</span><span class="n">mrca</span><span class="p">,</span> <span class="n">update_bipartitions</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
</pre></div>
</div>
<p>which results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(</span><span class="n">A</span><span class="p">,(</span><span class="n">B</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">))));</span>

<span class="o">/----------------------------------------------------</span> <span class="n">A</span>
<span class="o">+</span>
<span class="o">|</span>            <span class="o">/---------------------------------------</span> <span class="n">B</span>
\<span class="o">------------+</span>
             <span class="o">|</span>            <span class="o">/--------------------------</span> <span class="n">C</span>
             \<span class="o">------------+</span>
                          <span class="o">|</span>            <span class="o">/-------------</span> <span class="n">D</span>
                          \<span class="o">------------+</span>
                                       \<span class="o">-------------</span> <span class="n">E</span>


<span class="n">After</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">)));</span>

<span class="o">/----------------------------------------------------</span> <span class="n">D</span>
<span class="o">|</span>
<span class="o">+----------------------------------------------------</span> <span class="n">E</span>
<span class="o">|</span>
<span class="o">|</span>                <span class="o">/-----------------------------------</span> <span class="n">C</span>
\<span class="o">----------------+</span>
                 <span class="o">|</span>                 <span class="o">/-----------------</span> <span class="n">B</span>
                 \<span class="o">-----------------+</span>
                                   \<span class="o">-----------------</span> <span class="n">A</span>
</pre></div>
</div>
<p>You can also reroot the tree such that a particular node is moved to the outgroup position using the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.to_outgroup_position" title="dendropy.datamodel.treemodel.Tree.to_outgroup_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_outgroup_position</span></code></a>, which takes a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> as the first argument. Again, you can update the splits hashes <em>in situ</em> by passing <code class="docutils literal notranslate"><span class="pre">True</span></code> to the second argument, and again, here we do not because we are not carrying out any calculations. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] (A, (B, (C, (D, E))));&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">tree_str</span><span class="p">,</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
<span class="n">outgroup_node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">find_node_with_taxon_label</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">to_outgroup_position</span><span class="p">(</span><span class="n">outgroup_node</span><span class="p">,</span> <span class="n">update_bipartitions</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
</pre></div>
</div>
<p>which will result in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(</span><span class="n">A</span><span class="p">,(</span><span class="n">B</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">))));</span>

<span class="o">/----------------------------------------------------</span> <span class="n">A</span>
<span class="o">+</span>
<span class="o">|</span>            <span class="o">/---------------------------------------</span> <span class="n">B</span>
\<span class="o">------------+</span>
             <span class="o">|</span>            <span class="o">/--------------------------</span> <span class="n">C</span>
             \<span class="o">------------+</span>
                          <span class="o">|</span>            <span class="o">/-------------</span> <span class="n">D</span>
                          \<span class="o">------------+</span>
                                       \<span class="o">-------------</span> <span class="n">E</span>


<span class="n">After</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">),(</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">));</span>

<span class="o">/----------------------------------------------------</span> <span class="n">C</span>
<span class="o">|</span>
<span class="o">|</span>                         <span class="o">/--------------------------</span> <span class="n">D</span>
<span class="o">+-------------------------+</span>
<span class="o">|</span>                         \<span class="o">--------------------------</span> <span class="n">E</span>
<span class="o">|</span>
<span class="o">|</span>                         <span class="o">/--------------------------</span> <span class="n">B</span>
\<span class="o">-------------------------+</span>
                          \<span class="o">--------------------------</span> <span class="n">A</span>
</pre></div>
</div>
<p>If you have a tree with edge lengths specified, you can reroot it at the midpoint, using the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.reroot_at_midpoint" title="dendropy.datamodel.treemodel.Tree.reroot_at_midpoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reroot_at_midpoint</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] (A:0.55, (B:0.82, (C:0.74, (D:0.42, E:0.64):0.24):0.15):0.20):0.3;&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">tree_str</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">(</span><span class="n">plot_metric</span><span class="o">=</span><span class="s1">&#39;length&#39;</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">reroot_at_midpoint</span><span class="p">(</span><span class="n">update_bipartitions</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">(</span><span class="n">plot_metric</span><span class="o">=</span><span class="s1">&#39;length&#39;</span><span class="p">))</span>

</pre></div>
</div>
<p>which results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(</span><span class="n">A</span><span class="p">:</span><span class="mf">0.55</span><span class="p">,(</span><span class="n">B</span><span class="p">:</span><span class="mf">0.82</span><span class="p">,(</span><span class="n">C</span><span class="p">:</span><span class="mf">0.74</span><span class="p">,(</span><span class="n">D</span><span class="p">:</span><span class="mf">0.42</span><span class="p">,</span><span class="n">E</span><span class="p">:</span><span class="mf">0.64</span><span class="p">):</span><span class="mf">0.24</span><span class="p">):</span><span class="mf">0.15</span><span class="p">):</span><span class="mf">0.2</span><span class="p">):</span><span class="mf">0.3</span><span class="p">;</span>

          <span class="o">/-------------------</span> <span class="n">A</span>
          <span class="o">+</span>
          <span class="o">|</span>      <span class="o">/----------------------------</span> <span class="n">B</span>
          \<span class="o">------+</span>
                 <span class="o">|</span>    <span class="o">/--------------------------</span> <span class="n">C</span>
                 \<span class="o">----+</span>
                      <span class="o">|</span>        <span class="o">/--------------</span> <span class="n">D</span>
                      \<span class="o">--------+</span>
                               \<span class="o">----------------------</span> <span class="n">E</span>


<span class="n">After</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">C</span><span class="p">:</span><span class="mf">0.74</span><span class="p">,(</span><span class="n">D</span><span class="p">:</span><span class="mf">0.42</span><span class="p">,</span><span class="n">E</span><span class="p">:</span><span class="mf">0.64</span><span class="p">):</span><span class="mf">0.24</span><span class="p">):</span><span class="mf">0.045</span><span class="p">,(</span><span class="n">B</span><span class="p">:</span><span class="mf">0.82</span><span class="p">,</span><span class="n">A</span><span class="p">:</span><span class="mf">0.75</span><span class="p">):</span><span class="mf">0.105</span><span class="p">):</span><span class="mf">0.3</span><span class="p">;</span>

               <span class="o">/-------------------------------</span> <span class="n">C</span>
             <span class="o">/-+</span>
             <span class="o">|</span> <span class="o">|</span>         <span class="o">/------------------</span> <span class="n">D</span>
             <span class="o">|</span> \<span class="o">---------+</span>
             <span class="o">+</span>           \<span class="o">----------------------------</span> <span class="n">E</span>
             <span class="o">|</span>
             <span class="o">|</span>   <span class="o">/------------------------------------</span> <span class="n">B</span>
             \<span class="o">---+</span>
                 \<span class="o">--------------------------------</span> <span class="n">A</span>
</pre></div>
</div>
</section>
</section>
<section id="pruning-subtrees-and-tips">
<h2>Pruning Subtrees and Tips<a class="headerlink" href="#pruning-subtrees-and-tips" title="Link to this heading">¶</a></h2>
<p>To remove a set of tips from a <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>, you can use either the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.prune_taxa" title="dendropy.datamodel.treemodel.Tree.prune_taxa"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prune_taxa</span></code></a> or the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.prune_taxa_with_labels" title="dendropy.datamodel.treemodel.Tree.prune_taxa_with_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prune_taxa_with_labels</span></code></a> methods. The first takes a container of <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.TaxonNamespace" title="dendropy.datamodel.taxonmodel.TaxonNamespace"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaxonNamespace</span></code></a> objects as an argument, while the second takes container of strings. In both cases, nodes associated with the specified taxa (as given by the <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.TaxonNamespace" title="dendropy.datamodel.taxonmodel.TaxonNamespace"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaxonNamespace</span></code></a> objects directly in the first case, or <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.TaxonNamespace" title="dendropy.datamodel.taxonmodel.TaxonNamespace"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaxonNamespace</span></code></a> objects with labels given in the list of string in the second case) will be removed from the tree. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] ((A, (B, (C, (D, E)))),(F, (G, H)));&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">tree_str</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
<span class="n">tree</span><span class="o">.</span><span class="n">prune_taxa_with_labels</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>

</pre></div>
</div>
<p>which results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">A</span><span class="p">,(</span><span class="n">B</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">)))),(</span><span class="n">F</span><span class="p">,(</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">)));</span>

          <span class="o">/-------------------------------------------</span> <span class="n">A</span>
<span class="o">/---------+</span>
<span class="o">|</span>         <span class="o">|</span>          <span class="o">/--------------------------------</span> <span class="n">B</span>
<span class="o">|</span>         \<span class="o">----------+</span>
<span class="o">|</span>                    <span class="o">|</span>          <span class="o">/---------------------</span> <span class="n">C</span>
<span class="o">|</span>                    \<span class="o">----------+</span>
<span class="o">+</span>                               <span class="o">|</span>          <span class="o">/----------</span> <span class="n">D</span>
<span class="o">|</span>                               \<span class="o">----------+</span>
<span class="o">|</span>                                          \<span class="o">----------</span> <span class="n">E</span>
<span class="o">|</span>
<span class="o">|</span>                               <span class="o">/---------------------</span> <span class="n">F</span>
\<span class="o">-------------------------------+</span>
                                <span class="o">|</span>          <span class="o">/----------</span> <span class="n">G</span>
                                \<span class="o">----------+</span>
                                           \<span class="o">----------</span> <span class="n">H</span>


<span class="n">After</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">B</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">)),(</span><span class="n">F</span><span class="p">,</span><span class="n">H</span><span class="p">));</span>

                  <span class="o">/-----------------------------------</span> <span class="n">B</span>
<span class="o">/-----------------+</span>
<span class="o">|</span>                 <span class="o">|</span>                 <span class="o">/-----------------</span> <span class="n">D</span>
<span class="o">|</span>                 \<span class="o">-----------------+</span>
<span class="o">+</span>                                   \<span class="o">-----------------</span> <span class="n">E</span>
<span class="o">|</span>
<span class="o">|</span>                                   <span class="o">/-----------------</span> <span class="n">F</span>
\<span class="o">-----------------------------------+</span>
                                    \<span class="o">-----------------</span> <span class="n">H</span>
</pre></div>
</div>
<p>Alternatively, the tree can be pruned based on a set of taxa that you want to <em>keep</em>. This can be affected through the use of the counterpart “retain” methods, <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.retain_taxa" title="dendropy.datamodel.treemodel.Tree.retain_taxa"><code class="xref py py-meth docutils literal notranslate"><span class="pre">retain_taxa</span></code></a> and <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.retain_taxa_with_labels" title="dendropy.datamodel.treemodel.Tree.retain_taxa_with_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">retain_taxa_with_labels</span></code></a>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] ((A, (B, (C, (D, E)))),(F, (G, H)));&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">tree_str</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
<span class="n">tree</span><span class="o">.</span><span class="n">retain_taxa_with_labels</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>

</pre></div>
</div>
<p>which results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">A</span><span class="p">,(</span><span class="n">B</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">)))),(</span><span class="n">F</span><span class="p">,(</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">)));</span>

          <span class="o">/-------------------------------------------</span> <span class="n">A</span>
<span class="o">/---------+</span>
<span class="o">|</span>         <span class="o">|</span>          <span class="o">/--------------------------------</span> <span class="n">B</span>
<span class="o">|</span>         \<span class="o">----------+</span>
<span class="o">|</span>                    <span class="o">|</span>          <span class="o">/---------------------</span> <span class="n">C</span>
<span class="o">|</span>                    \<span class="o">----------+</span>
<span class="o">+</span>                               <span class="o">|</span>          <span class="o">/----------</span> <span class="n">D</span>
<span class="o">|</span>                               \<span class="o">----------+</span>
<span class="o">|</span>                                          \<span class="o">----------</span> <span class="n">E</span>
<span class="o">|</span>
<span class="o">|</span>                               <span class="o">/---------------------</span> <span class="n">F</span>
\<span class="o">-------------------------------+</span>
                                <span class="o">|</span>          <span class="o">/----------</span> <span class="n">G</span>
                                \<span class="o">----------+</span>
                                           \<span class="o">----------</span> <span class="n">H</span>


<span class="n">After</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">C</span><span class="p">),</span><span class="n">G</span><span class="p">);</span>

                           <span class="o">/--------------------------</span> <span class="n">A</span>
<span class="o">/--------------------------+</span>
<span class="o">+</span>                          \<span class="o">--------------------------</span> <span class="n">C</span>
<span class="o">|</span>
\<span class="o">-----------------------------------------------------</span> <span class="n">G</span>
</pre></div>
</div>
<p>Again, it should be noted that, as these operations modify the structure of the tree, you need to call <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.update_bipartitions" title="dendropy.datamodel.treemodel.Tree.update_bipartitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bipartitions</span></code></a> to update the internal splits hashes, before carrying out any calculations, comparisons, or metrics.</p>
</section>
<section id="extracting-trees-and-subtrees-from-an-existing-tree">
<h2>Extracting Trees and Subtrees from an Existing Tree<a class="headerlink" href="#extracting-trees-and-subtrees-from-an-existing-tree" title="Link to this heading">¶</a></h2>
<p>If you just need a tree <em>structure</em>, i.e. the nodes and edges, and minimal other attributes, such as taxon associations, node and edge labels, and edge lengths, the following methods provide fast and powerful ways to give you copies of the current tree or parts of the current tree:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.extract_tree" title="dendropy.datamodel.treemodel.Tree.extract_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.extract_tree_with_taxa" title="dendropy.datamodel.treemodel.Tree.extract_tree_with_taxa"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree_with_taxa</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.extract_tree_without_taxa" title="dendropy.datamodel.treemodel.Tree.extract_tree_without_taxa"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree_without_taxa</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.extract_tree_with_taxa_labels" title="dendropy.datamodel.treemodel.Tree.extract_tree_with_taxa_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree_with_taxa_labels</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.extract_tree_without_taxa_labels" title="dendropy.datamodel.treemodel.Tree.extract_tree_without_taxa_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree_without_taxa_labels</span></code></a></p></li>
</ul>
<p>All these methods create a “thin” or “light” copy of the tree, optionally pruning out nodes based on criteria.</p>
<p>The basic <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.extract_tree" title="dendropy.datamodel.treemodel.Tree.extract_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree</span></code></a> method returns a full clone of the structure of the source tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dendropy</span>
<span class="kn">from</span> <span class="nn">dendropy.calculate</span> <span class="kn">import</span> <span class="n">treecompare</span>

<span class="n">tree0</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">nd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tree0</span><span class="p">):</span>
    <span class="n">nd</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;hello, world</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;world, hello</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="n">nd</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
    <span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;taste&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sweet&quot;</span>
<span class="n">tree1</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">tree0</span><span class="o">.</span><span class="n">taxon_namespace</span> <span class="ow">is</span> <span class="n">tree1</span><span class="o">.</span><span class="n">taxon_namespace</span>
<span class="k">assert</span> <span class="n">treecompare</span><span class="o">.</span><span class="n">weighted_robinson_foulds_distance</span><span class="p">(</span>
        <span class="n">tree0</span><span class="p">,</span> <span class="n">tree1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span>

<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">tree1</span><span class="p">:</span>
    <span class="n">original_node</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">extraction_source</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> on extracted tree corresponds to </span><span class="si">{}</span><span class="s2"> on original tree&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">nd</span><span class="p">,</span> <span class="n">original_node</span><span class="p">))</span>
    <span class="c1">## basic attributes copied</span>
    <span class="k">assert</span> <span class="n">nd</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">original_node</span><span class="o">.</span><span class="n">label</span>
    <span class="k">assert</span> <span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">original_node</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">label</span>
    <span class="k">assert</span> <span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="n">original_node</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">length</span>
    <span class="c1">## but not annotations</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">annotations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_node</span><span class="o">.</span><span class="n">annotations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">annotations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_node</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">annotations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>


</pre></div>
</div>
<p>As can be seen, the nodes on the extracted tree have an attribute set on them, “<code class="docutils literal notranslate"><span class="pre">extraction_source</span></code>” that point to the corresponding node on the original tree.
Note how while labels, taxon associations and edge lengths are copied, the metadata annotations are not.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">node_filter_fn</span></code> argument provides a powerful and flexible way to selective pull out parts of the tree that might interest you:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree0</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>

<span class="n">node_filter_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">nd</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">taxon</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">nd</span><span class="o">.</span><span class="n">taxon</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Morelia&quot;</span><span class="p">)</span>
<span class="n">tree1</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree</span><span class="p">(</span><span class="n">node_filter_fn</span><span class="o">=</span><span class="n">node_filter_fn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>If you do not need the annotations, then this approach can be dramatically more performant than cloning and then pruning the tree. For example, the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>
<span class="kn">import</span> <span class="nn">timeit</span>

<span class="n">tree0</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>
<span class="n">taxa_to_prune</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">taxon</span> <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">tree0</span><span class="o">.</span><span class="n">taxon_namespace</span>
        <span class="k">if</span> <span class="n">taxon</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Morelia&quot;</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">f1</span><span class="p">():</span>
    <span class="n">tree1</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="p">(</span><span class="n">tree0</span><span class="p">)</span>
    <span class="n">tree1</span><span class="o">.</span><span class="n">prune_taxa</span><span class="p">(</span><span class="n">taxa_to_prune</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f2</span><span class="p">():</span>
    <span class="n">tree1</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree</span><span class="p">(</span>
            <span class="n">node_filter_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">taxon</span><span class="p">:</span> <span class="n">taxon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxa_to_prune</span><span class="p">)</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>

<span class="n">t2</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.00191879272461</span>
<span class="mf">0.000579190254211</span>
</pre></div>
</div>
<p>Some convenience wrappers around the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.extract_tree" title="dendropy.datamodel.treemodel.Tree.extract_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree</span></code></a> method allow you to more easily pull out or drop taxa of interest, either by passing in the <a class="reference internal" href="../library/taxonmodel.html#dendropy.datamodel.taxonmodel.Taxon" title="dendropy.datamodel.taxonmodel.Taxon"><code class="xref py py-class docutils literal notranslate"><span class="pre">Taxon</span></code></a> instances directly or their labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>
<span class="kn">from</span> <span class="nn">dendropy.calculate</span> <span class="kn">import</span> <span class="n">treecompare</span>

<span class="n">tree0</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;pythonidae.mle.nex&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;nexus&quot;</span><span class="p">)</span>

<span class="n">morelia_taxa</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">taxon</span> <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">tree0</span><span class="o">.</span><span class="n">taxon_namespace</span>
        <span class="k">if</span> <span class="n">taxon</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Morelia&quot;</span><span class="p">))</span>
<span class="n">morelia_labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">morelia_taxa</span><span class="p">])</span>
<span class="n">non_morelia_taxa</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">taxon</span> <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">tree0</span><span class="o">.</span><span class="n">taxon_namespace</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">taxon</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Morelia&quot;</span><span class="p">))</span>
<span class="n">non_morelia_labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">non_morelia_taxa</span><span class="p">])</span>

<span class="n">tree1</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree_with_taxa</span><span class="p">(</span><span class="n">taxa</span><span class="o">=</span><span class="n">morelia_taxa</span><span class="p">)</span>
<span class="n">tree2</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree_with_taxa_labels</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">morelia_labels</span><span class="p">)</span>
<span class="n">tree3</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree_without_taxa</span><span class="p">(</span><span class="n">taxa</span><span class="o">=</span><span class="n">non_morelia_taxa</span><span class="p">)</span>
<span class="n">tree4</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree_without_taxa_labels</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">non_morelia_labels</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree2</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree3</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree4</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="s2">&quot;newick&quot;</span><span class="p">))</span>

<span class="k">assert</span> <span class="n">treecompare</span><span class="o">.</span><span class="n">weighted_robinson_foulds_distance</span><span class="p">(</span><span class="n">tree1</span><span class="p">,</span> <span class="n">tree2</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> \
    <span class="n">treecompare</span><span class="o">.</span><span class="n">weighted_robinson_foulds_distance</span><span class="p">(</span><span class="n">tree1</span><span class="p">,</span> <span class="n">tree2</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">treecompare</span><span class="o">.</span><span class="n">weighted_robinson_foulds_distance</span><span class="p">(</span><span class="n">tree2</span><span class="p">,</span> <span class="n">tree3</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> \
    <span class="n">treecompare</span><span class="o">.</span><span class="n">weighted_robinson_foulds_distance</span><span class="p">(</span><span class="n">tree2</span><span class="p">,</span> <span class="n">tree3</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">treecompare</span><span class="o">.</span><span class="n">weighted_robinson_foulds_distance</span><span class="p">(</span><span class="n">tree3</span><span class="p">,</span> <span class="n">tree4</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> \
    <span class="n">treecompare</span><span class="o">.</span><span class="n">weighted_robinson_foulds_distance</span><span class="p">(</span><span class="n">tree3</span><span class="p">,</span> <span class="n">tree4</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also use the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.extract_tree" title="dendropy.datamodel.treemodel.Tree.extract_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_tree</span></code></a> method to created a “casted” copy, i.e. a (light) copy of the tree using your own custom classes instead of DendroPy’s native <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree" title="dendropy.datamodel.treemodel.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> and <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Node" title="dendropy.datamodel.treemodel.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> classes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>


<span class="c1"># Our custom node class. We do not actually need to derive from dendropy.Node.</span>
<span class="c1"># Doing so, though, ensures that all the required methods exist instead of</span>
<span class="c1"># having to write them ourselves.</span>
<span class="k">class</span> <span class="nc">PhyloNode</span><span class="p">(</span><span class="n">dendropy</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="c1"># Our custom tree class. Note that the definition of node factory</span>
<span class="c1"># (class-)method here ensures that nodes created are of the type we we want.</span>
<span class="c1"># Many DendroPy methods, include &#39;Tree.extract_tree()&#39; check and preferentially</span>
<span class="c1"># use the return value of tree&#39;s class&#39; ``node_factory()`` method when building</span>
<span class="c1"># trees. Note also that we do not actually need to derive from dendropy.Tree.</span>
<span class="c1"># Doing so, though, ensures that all the required methods exist instead of</span>
<span class="c1"># having to write them ourselves.</span>
<span class="k">class</span> <span class="nc">PhyloTree</span><span class="p">(</span><span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">node_factory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PhyloNode</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="c1"># The original tree using dendropy.Tree for the tree and dendropy.Node for the</span>
<span class="c1"># nodes.</span>
<span class="n">tree0</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="s2">&quot;(a,(b,(c,d)));&quot;</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tree0</span><span class="p">))</span> <span class="c1"># dendropy.Tree</span>
<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">tree0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span> <span class="c1"># dendropy.Node</span>

<span class="c1"># Default extraction: use dendropy.Tree for tree</span>
<span class="c1"># and dendropy.Node for node</span>
<span class="n">tree1</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tree1</span><span class="p">))</span> <span class="c1"># dendropy.Tree</span>
<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">tree1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span> <span class="c1"># dendropy.Node</span>

<span class="c1"># Node factory defaults to ``node_factory`` method</span>
<span class="c1"># of instance returned by ``tree_factory`` if</span>
<span class="c1"># ``tree_factory is specified.</span>
<span class="n">tree2</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree</span><span class="p">(</span><span class="n">tree_factory</span><span class="o">=</span><span class="n">PhyloTree</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tree2</span><span class="p">))</span> <span class="c1"># PhyloTree</span>
<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">tree2</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span> <span class="c1"># PhyloNode</span>

<span class="c1"># equivalent to above</span>
<span class="n">tree3</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree</span><span class="p">(</span><span class="n">tree_factory</span><span class="o">=</span><span class="n">PhyloTree</span><span class="p">,</span>
        <span class="n">node_factory</span><span class="o">=</span><span class="n">PhyloNode</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tree3</span><span class="p">))</span> <span class="c1"># PhyloTree</span>
<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">tree3</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span> <span class="c1"># PhyloNode</span>

<span class="c1"># Use dendropy.Tree for tree but</span>
<span class="c1"># PhyloNode for node</span>
<span class="n">tree4</span> <span class="o">=</span> <span class="n">tree0</span><span class="o">.</span><span class="n">extract_tree</span><span class="p">(</span><span class="n">node_factory</span><span class="o">=</span><span class="n">PhyloNode</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tree4</span><span class="p">))</span> <span class="c1"># dendropy.Tree</span>
<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">tree4</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span> <span class="c1"># PhyloNode</span>
</pre></div>
</div>
</section>
<section id="rotating">
<h2>Rotating<a class="headerlink" href="#rotating" title="Link to this heading">¶</a></h2>
<p>You can ladderize trees (sort the child nodes in order of the number of their children) by calling the <a class="reference internal" href="../library/treemodel.html#dendropy.datamodel.treemodel.Tree.ladderize" title="dendropy.datamodel.treemodel.Tree.ladderize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ladderize</span></code></a> method. This method takes one argument, <code class="docutils literal notranslate"><span class="pre">ascending</span></code>. If <code class="docutils literal notranslate"><span class="pre">ascending=True</span></code>, which is the default, then the nodes are sorted in ascending order (i.e., nodes with fewer children sort before nodes with more children). If <code class="docutils literal notranslate"><span class="pre">ascending=False</span></code>, then the nodes are sorted in descending order (i.e., nodes with more children sorting before nodes with fewer children). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">dendropy</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="s2">&quot;[&amp;R] ((A, (B, (C, (D, E)))),(F, (G, H)));&quot;</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">dendropy</span><span class="o">.</span><span class="n">Tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">tree_str</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;newick&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
<span class="n">tree</span><span class="o">.</span><span class="n">ladderize</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ladderize, ascending=True:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>
<span class="n">tree</span><span class="o">.</span><span class="n">ladderize</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ladderize, ascending=False:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="s1">&#39;newick&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">as_ascii_plot</span><span class="p">())</span>

</pre></div>
</div>
<p>results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">A</span><span class="p">,(</span><span class="n">B</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">)))),(</span><span class="n">F</span><span class="p">,(</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">)));</span>

          <span class="o">/-------------------------------------------</span> <span class="n">A</span>
<span class="o">/---------+</span>
<span class="o">|</span>         <span class="o">|</span>          <span class="o">/--------------------------------</span> <span class="n">B</span>
<span class="o">|</span>         \<span class="o">----------+</span>
<span class="o">|</span>                    <span class="o">|</span>          <span class="o">/---------------------</span> <span class="n">C</span>
<span class="o">|</span>                    \<span class="o">----------+</span>
<span class="o">+</span>                               <span class="o">|</span>          <span class="o">/----------</span> <span class="n">D</span>
<span class="o">|</span>                               \<span class="o">----------+</span>
<span class="o">|</span>                                          \<span class="o">----------</span> <span class="n">E</span>
<span class="o">|</span>
<span class="o">|</span>                               <span class="o">/---------------------</span> <span class="n">F</span>
\<span class="o">-------------------------------+</span>
                                <span class="o">|</span>          <span class="o">/----------</span> <span class="n">G</span>
                                \<span class="o">----------+</span>
                                           \<span class="o">----------</span> <span class="n">H</span>


<span class="n">Ladderize</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">((</span><span class="n">F</span><span class="p">,(</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">)),(</span><span class="n">A</span><span class="p">,(</span><span class="n">B</span><span class="p">,(</span><span class="n">C</span><span class="p">,(</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">)))));</span>

                                <span class="o">/---------------------</span> <span class="n">F</span>
<span class="o">/-------------------------------+</span>
<span class="o">|</span>                               <span class="o">|</span>          <span class="o">/----------</span> <span class="n">G</span>
<span class="o">|</span>                               \<span class="o">----------+</span>
<span class="o">+</span>                                          \<span class="o">----------</span> <span class="n">H</span>
<span class="o">|</span>
<span class="o">|</span>         <span class="o">/-------------------------------------------</span> <span class="n">A</span>
\<span class="o">---------+</span>
          <span class="o">|</span>          <span class="o">/--------------------------------</span> <span class="n">B</span>
          \<span class="o">----------+</span>
                     <span class="o">|</span>          <span class="o">/---------------------</span> <span class="n">C</span>
                     \<span class="o">----------+</span>
                                <span class="o">|</span>          <span class="o">/----------</span> <span class="n">D</span>
                                \<span class="o">----------+</span>
                                           \<span class="o">----------</span> <span class="n">E</span>


<span class="n">Ladderize</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">:</span>
<span class="p">[</span><span class="o">&amp;</span><span class="n">R</span><span class="p">]</span> <span class="p">(((((</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">),</span><span class="n">C</span><span class="p">),</span><span class="n">B</span><span class="p">),</span><span class="n">A</span><span class="p">),((</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">),</span><span class="n">F</span><span class="p">));</span>

                                           <span class="o">/----------</span> <span class="n">D</span>
                                <span class="o">/----------+</span>
                     <span class="o">/----------+</span>          \<span class="o">----------</span> <span class="n">E</span>
                     <span class="o">|</span>          <span class="o">|</span>
          <span class="o">/----------+</span>          \<span class="o">---------------------</span> <span class="n">C</span>
          <span class="o">|</span>          <span class="o">|</span>
<span class="o">/---------+</span>          \<span class="o">--------------------------------</span> <span class="n">B</span>
<span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span>         \<span class="o">-------------------------------------------</span> <span class="n">A</span>
<span class="o">+</span>
<span class="o">|</span>                                          <span class="o">/----------</span> <span class="n">G</span>
<span class="o">|</span>                               <span class="o">/----------+</span>
\<span class="o">-------------------------------+</span>          \<span class="o">----------</span> <span class="n">H</span>
                                <span class="o">|</span>
                                \<span class="o">---------------------</span> <span class="n">F</span>
</pre></div>
</div>
<p>Tree rotation operations do not actually change the tree structure, at least in so far as splits are concerned, so it is not neccessary to update the splits hashes.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div style="text-align: center; padding-top: 20px; padding-bottom: 5px; width: 100%;">
    <a href="../index.html"><img src="../_static/dendropy_logo.png" /></a>
</div><div style="clear:both; width: 100%; height:1px;"></div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div style="clear:both; width: 100%; height:1px;"></div>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Tree Manipulation and Restructuring</a><ul>
<li><a class="reference internal" href="#rooting-derooting-and-rerooting">Rooting, Derooting and Rerooting</a><ul>
<li><a class="reference internal" href="#the-rooting-of-tree-s-read-from-external-sources">The Rooting of Tree(s) Read from External Sources</a></li>
<li><a class="reference internal" href="#setting-the-rooting-state">Setting the Rooting State</a></li>
<li><a class="reference internal" href="#derooting">Derooting</a></li>
<li><a class="reference internal" href="#rerooting">Rerooting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pruning-subtrees-and-tips">Pruning Subtrees and Tips</a></li>
<li><a class="reference internal" href="#extracting-trees-and-subtrees-from-an-existing-tree">Extracting Trees and Subtrees from an Existing Tree</a></li>
<li><a class="reference internal" href="#rotating">Rotating</a></li>
</ul>
</li>
</ul>

  </div><div style="clear:both; width: 100%; height:1px;"></div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="treestats.html"
                          title="previous chapter">Tree Statistics, Metrics, Summarizations, and Other Calculations</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="bipartitions.html"
                          title="next chapter">Bipartitions</a></p>
  </div><div style="clear:both; width: 100%; height:1px;"></div>
    <!-- Documentation -->
    <div style="border-top: double 1px white; padding-top: 10px;">
        <h3>Documentation</h3>
        <ul>
            <li><a href="downloading.html">Downloading and Installing DendroPy</a></li>
            <li><a href="index.html">The DendroPy Primer</a></li>
            <li><a href="../library/index.html">Library API Reference</a></li>
            <li>
                <a href="../schemas/index.html">Schemas</a>
                <ul>
                    <li><a href="../schemas/fasta.html">FASTA</a></li>
                    <li><a href="../schemas/newick.html">Newick</a></li>
                    <li><a href="../schemas/nexml.html">NeXML</a></li>
                    <li><a href="../schemas/nexus.html">Nexus</a></li>
                    <li><a href="../schemas/phylip.html">PHYLIP</a></li>
                </ul>
            </li>
            <li>
                <a href="../programs/index.html">Programs</a>
                <ul>
                    <li><a href="../programs/sumtrees.html">SumTrees</a></li>
                </ul>
            </li>
            <li><a href="../glossary.html">Glossary and Terminological Reference</a></li>
            <li><a href="../developer.html">Developer Guide</a></li>
            <li><a href="../planning.html">Ongoing Development</a></li>
            <li><a href="../changes.html">Change History</a></li>
        </ul>
    </div>

    <!-- Downloads -->
    <div style="border-top: double 1px white; padding-top: 10px;">
        <h3>Obtaining</h3>
        <ul>
            <li><a target="_blank" href="http://pypi.python.org/pypi/DendroPy">Install from the Python Package Index</a></li>
            <li><a target="_blank" href="http://pypi.python.org/packages/source/D/DendroPy/DendroPy-5.0.5.tar.gz">Download the Source Code Archive</a></li>
            <li><a target="_blank" href="http://github.com/jeetsukumaran/DendroPy">Clone the Source Code Repository</a></li>
        </ul>
    </div>

    <!-- Discussions -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative;">
        <h3><span style="text-align: left">Discussion</span><span style="position: absolute; right: 0; top: 10px "><img src="../_static/google-groups-logo1.png" height="20px" alt="Google Groups" /></span></h3>
        <div style="margin-top: 15px;">
            <p style="font-size: 90%; margin-top: 3px; clear: both;">Join the <a href="http://groups.google.com/group/dendropy-users?hl=en">&quot; DendroPy Users&quot; </a>group to follow and participate in discussion, troubleshooting, help, information, suggestions, etc. on the usage and development of the DendroPy phylogenetic computing library.</p>
            <form action="http://groups.google.com/group/dendropy-users/boxsubscribe">
                <input type=text name=email>
                <input type=submit name="sub" value="Subscribe">
            </form>
            <p style="font-size: 90%; clear: both; padding-top: 5px; padding-bottom: 10px;">Enter your e-mail address in the box above and click the &quot;subscribe&quot; button to subscribe to the <a href="http://groups.google.com/group/dendropy-users?hl=en">&quot;dendropy-users&quot;</a> group, or click <a href="http://groups.google.com/group/dendropy-users?hl=en">here</a> to visit this group page directly.</p>
        </div>
    </div>

    <!-- Announcements -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative;">
        <h3><span style="text-align: left">Announcements</span><span style="position: absolute; right: 0; top: 10px "><img src="../_static/google-groups-logo1.png" height="20px" alt="Google Groups" /></span></h3>
        <div style="margin-top: 15px;">
            <p style="font-size: 90%; margin-top: 3px; clear: both;">Join the <a href="http://groups.google.com/group/dendropy-announce?hl=en">&quot; DendroPy Announcements&quot; </a>group to receive announcements of new releases, updates, changes and other news of interest to DendroPy users and developers.</p>
            <form action="http://groups.google.com/group/dendropy-announce/boxsubscribe">
                <input type=text name=email>
                <input type=submit name="sub" value="Subscribe">
            </form>
            <p style="font-size: 90%; clear: both; padding-top: 5px; padding-bottom: 10px;">Enter your e-mail address in the box above and click the &quot;subscribe&quot; button to subscribe to the <a href="http://groups.google.com/group/dendropy-announce?hl=en">&quot; dendropy-announce&quot; </a>group, or click <a href="http://groups.google.com/group/dendropy-announce?hl=en">here</a> to visit this group page directly.</p>
        </div>
    </div>

    <!-- Development -->
    <div style="border-top: double 1px white; padding-top: 10px; position: relative; padding-bottom: 15px; margin-bottom:5px;">
        <h3><span style="text-align: left"><a href="https://github.com/jeetsukumaran/DendroPy/">Development</a></span><a href="https://github.com/jeetsukumaran/DendroPy/"><span style="position: absolute; right: 0; top: 10px "><img src="../_static/Octocat.png" height="30px" alt="GitHub" /></span></a></h3>
        <div style="margin-top: 15px;">
            <!-- <a href="https://github.com/jeetsukumaran/DendroPy/issues">Issues</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/subscription">Watch</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/fork">Fork</a> &bull; <a href="https://github.com/jeetsukumaran/DendroPy/stargazers">Star</a> &bull; <a href="https://github.com/jeetsukumaran/">Follow</a> -->
            <ul>
                <li>                <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/issues"><code>Issues</code></a></span> <span style="font-style: italic; font-size:80%;"> - Report bugs or request features</span></li>
                <li>     <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/subscription"><code>&nbsp;Watch</code></a></span> <span style="font-style: italic; font-size:80%;"> - Follow development activity</span></li>
                <li>        <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/fork"><code>&nbsp;&nbsp;Fork</code></a></span> <span style="font-style: italic; font-size:80%;"> - Contribute and collaborate</span></li>
                <li>  <span style="font-weight: bold;"><a href="https://github.com/jeetsukumaran/DendroPy/stargazers"><code>&nbsp;&nbsp;Star</code></a></span> <span style="font-style: italic; font-size:80%;"> - Throw some glitter, add some glamour</span></li>
        </div>
    </div>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bipartitions.html" title="Bipartitions"
             >next</a> |</li>
        <li class="right" >
          <a href="treestats.html" title="Tree Statistics, Metrics, Summarizations, and Other Calculations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DendroPy 5.0.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >The DendroPy Primer</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tree Manipulation and Restructuring</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2009-2025, Jeet Sukumaran and Mark T. Holder.
    </div>
  </body>
</html>